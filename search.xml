<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>使用 kubeadm 安装 kubernetes v1.15.3</title>
      <link href="/shi-yong-kubeadm-an-zhuang-kubernetes-v1-15-3/"/>
      <url>/shi-yong-kubeadm-an-zhuang-kubernetes-v1-15-3/</url>
      
        <content type="html"><![CDATA[<h1 id="配置要求"><a href="#配置要求" class="headerlink" title="配置要求"></a>配置要求</h1><hr><p>对于 Kubernetes 初学者，推荐在阿里云采购如下配置：（您也可以使用自己的虚拟机、私有云等您最容易获得的 Linux 环境） </p><ol><li><p>3台 2核4G 的ECS（突发性能实例 t5 ecs.t5-c1m2.large或同等配置，单台约 0.4元/小时，停机时不收费）</p></li><li><p>Cent OS 7.6安装后的软件版本为</p><ol><li>Kubernetes v1.15.3</li><li>calico 3.8.2</li><li>nginx-ingress 1.5.3</li><li>Docker 18.09.7</li></ol></li></ol><p>如果要安装 Kubernetes 历史版本，请参考：</p><blockquote><p><a href="https://kuboard.cn/install/history-k8s/install-k8s-1.15.2.html" target="_blank" rel="noopener">安装 Kubernetes v1.15.2 单Master节点</a></p></blockquote><blockquote><p><a href="https://kuboard.cn/install/history-k8s/install-k8s-1.15.1.html" target="_blank" rel="noopener">安装 Kubernetes v1.15.1 单Master节点</a></p></blockquote><p>安装后的拓扑图如下：下载拓扑图源文件 使用Axure RP 9.0可打开该文件</p><p><img src="https://kuboard.cn/assets/img/image-20190826000521999.4e674425.png" alt="拓扑图"></p><h2 id="关于二进制安装"><a href="#关于二进制安装" class="headerlink" title="关于二进制安装"></a>关于二进制安装</h2><blockquote><p>网上一直流传着一种 “二进制” 安装 Kubernetes 的方法，查了许久，未曾在 kubernetes.io 官方网站上看到任何关于此安装方法的介绍，也并没有看到任何关于 “二进制” 安装的优势，唯一的解释是：</p></blockquote><blockquote><p>由于众所周知的原因，在国内无法直接访问Google的服务。二进制包由于其下载方便、灵活定制而深受广大kubernetes使用者喜爱，成为企业部署生产环境比较流行的方式之一<br>鉴于目前已经有比较方便的办法获得 kubernetes 镜像，我将回避 二进制 安装是否更好的争论。本文采用 kubernetes.io 官方推荐的 kubeadm 工具安装 kubernetes 集群。</p></blockquote><h1 id="检查-centos-hostname"><a href="#检查-centos-hostname" class="headerlink" title="检查 centos / hostname"></a>检查 centos / hostname</h1><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 在 master 节点和 worker 节点都要执行</span><span class="token function">cat</span> /etc/redhat-release<span class="token comment" spellcheck="true"># 此处 hostname 的输出将会是该机器在 Kubernetes 集群中的节点名字</span><span class="token comment" spellcheck="true"># 不能使用 localhost 作为节点的名字</span><span class="token function">hostname</span><span class="token comment" spellcheck="true"># 请使用 lscpu 命令，核对 CPU 信息</span><span class="token comment" spellcheck="true"># Architecture: x86_64    本安装文档不支持 arm 架构</span><span class="token comment" spellcheck="true"># CPU(s):       2         CPU 内核数量不能低于 2</span>lscpu<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="安装-docker-kubelet"><a href="#安装-docker-kubelet" class="headerlink" title="安装 docker / kubelet"></a>安装 docker / kubelet</h1><p>使用 <font color="red">root</font> 身份在所有节点执行如下代码，以安装软件：</p><ul><li>docker</li><li>nfs-utils</li><li>kubectl / kubeadm / kubelet kuai</li></ul><h2 id="快速安装"><a href="#快速安装" class="headerlink" title=" 快速安装"></a><font color="orange"> 快速安装</font></h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 在 master 节点和 worker 节点都要执行</span>curl -sSL https://kuboard.cn/install-script/v1.15.3/install-kubelet.sh <span class="token operator">|</span> sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h2><p><font color="red">请仔细研读脚本</font></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment" spellcheck="true"># 在 master 节点和 worker 节点都要执行</span><span class="token comment" spellcheck="true"># 安装 docker</span><span class="token comment" spellcheck="true"># 参考文档如下</span><span class="token comment" spellcheck="true"># https://docs.docker.com/install/linux/docker-ce/centos/ </span><span class="token comment" spellcheck="true"># https://docs.docker.com/install/linux/linux-postinstall/</span><span class="token comment" spellcheck="true"># 卸载旧版本</span>yum remove -y docker \docker-client \docker-client-latest \docker-common \docker-latest \docker-latest-logrotate \docker-logrotate \docker-selinux \docker-engine-selinux \docker-engine<span class="token comment" spellcheck="true"># 设置 yum repository</span>yum <span class="token function">install</span> -y yum-utils \device-mapper-persistent-data \lvm2yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span class="token comment" spellcheck="true"># 安装并启动 docker</span>yum <span class="token function">install</span> -y docker-ce-18.09.7 docker-ce-cli-18.09.7 containerd.iosystemctl <span class="token function">enable</span> dockersystemctl start docker<span class="token comment" spellcheck="true"># 安装 nfs-utils</span><span class="token comment" spellcheck="true"># 必须先安装 nfs-utils 才能挂载 nfs 网络存储</span>yum <span class="token function">install</span> -y nfs-utils<span class="token comment" spellcheck="true"># 关闭 防火墙</span>systemctl stop firewalldsystemctl disable firewalld<span class="token comment" spellcheck="true"># 关闭 SeLinux</span>setenforce 0<span class="token function">sed</span> -i <span class="token string">"s/SELINUX=enforcing/SELINUX=disabled/g"</span> /etc/selinux/config<span class="token comment" spellcheck="true"># 关闭 swap</span>swapoff -a<span class="token function">yes</span> <span class="token operator">|</span> <span class="token function">cp</span> /etc/fstab /etc/fstab_bak<span class="token function">cat</span> /etc/fstab_bak <span class="token operator">|</span><span class="token function">grep</span> -v swap <span class="token operator">></span> /etc/fstab<span class="token comment" spellcheck="true"># 修改 /etc/sysctl.conf</span><span class="token comment" spellcheck="true"># 如果有配置，则修改</span><span class="token function">sed</span> -i <span class="token string">"s#^net.ipv4.ip_forward.*#net.ipv4.ip_forward=1#g"</span>  /etc/sysctl.conf<span class="token function">sed</span> -i <span class="token string">"s#^net.bridge.bridge-nf-call-ip6tables.*#net.bridge.bridge-nf-call-ip6tables=1#g"</span>  /etc/sysctl.conf<span class="token function">sed</span> -i <span class="token string">"s#^net.bridge.bridge-nf-call-iptables.*#net.bridge.bridge-nf-call-iptables=1#g"</span>  /etc/sysctl.conf<span class="token comment" spellcheck="true"># 可能没有，追加</span><span class="token keyword">echo</span> <span class="token string">"net.ipv4.ip_forward = 1"</span> <span class="token operator">>></span> /etc/sysctl.conf<span class="token keyword">echo</span> <span class="token string">"net.bridge.bridge-nf-call-ip6tables = 1"</span> <span class="token operator">>></span> /etc/sysctl.conf<span class="token keyword">echo</span> <span class="token string">"net.bridge.bridge-nf-call-iptables = 1"</span> <span class="token operator">>></span> /etc/sysctl.conf<span class="token comment" spellcheck="true"># 执行命令以应用</span>sysctl -p<span class="token comment" spellcheck="true"># 配置K8S的yum源</span><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">></span> /etc/yum.repos.d/kubernetes.repo<span class="token punctuation">[</span>kubernetes<span class="token punctuation">]</span>name<span class="token operator">=</span>Kubernetesbaseurl<span class="token operator">=</span>http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64enabled<span class="token operator">=</span>1gpgcheck<span class="token operator">=</span>0repo_gpgcheck<span class="token operator">=</span>0gpgkey<span class="token operator">=</span>http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF<span class="token comment" spellcheck="true"># 卸载旧版本</span>yum remove -y kubelet kubeadm kubectl<span class="token comment" spellcheck="true"># 安装kubelet、kubeadm、kubectl</span>yum <span class="token function">install</span> -y kubelet-1.15.3 kubeadm-1.15.3 kubectl-1.15.3<span class="token comment" spellcheck="true"># 修改docker Cgroup Driver为systemd</span><span class="token comment" spellcheck="true"># # 将/usr/lib/systemd/system/docker.service文件中的这一行 ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><span class="token comment" spellcheck="true"># # 修改为 ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd</span><span class="token comment" spellcheck="true"># 如果不修改，在添加 worker 节点时可能会碰到如下错误</span><span class="token comment" spellcheck="true"># [WARNING IsDockerSystemdCheck]: detected "cgroupfs" as the Docker cgroup driver. The recommended driver is "systemd". </span><span class="token comment" spellcheck="true"># Please follow the guide at https://kubernetes.io/docs/setup/cri/</span><span class="token function">sed</span> -i <span class="token string">"s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g"</span> /usr/lib/systemd/system/docker.service<span class="token comment" spellcheck="true"># 设置 docker 镜像，提高 docker 镜像下载速度和稳定性</span><span class="token comment" spellcheck="true"># 如果您访问 https://hub.docker.io 速度非常稳定，亦可以跳过这个步骤</span>curl -sSL https://get.daocloud.io/daotools/set_mirror.sh <span class="token operator">|</span> sh -s http://f1361db2.m.daocloud.io<span class="token comment" spellcheck="true"># 重启 docker，并启动 kubelet</span>systemctl daemon-reloadsystemctl restart dockersystemctl <span class="token function">enable</span> kubelet <span class="token operator">&amp;&amp;</span> systemctl start kubeletdocker version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;如果此时执行 service status kubelet 命令，将得到 kubelet 启动失败的错误提示，请忽略此错误，因为必须完成后续步骤中 kubeadm init 的操作，kubelet 才能正常启动</p><h1 id="初始化-master-节点"><a href="#初始化-master-节点" class="headerlink" title="初始化 master 节点"></a>初始化 master 节点</h1><p>以 <font color="red">root</font> 身份在 demo-master-a-1 机器上执行<br>初始化 master 节点时，如果因为中间某些步骤的配置出错，想要重新初始化 master 节点，请先执行 <font color="red">kubeadm reset </font>操作</p><p>POD_SUBNET 所使用的网段不能与 master节点/worker节点 所在的网段重叠。该字段的取值为一个 CIDR 值，如果您对 CIDR 这个概念还不熟悉，请不要修改这个字段的取值 10.100.0.1/20</p><h3 id="快速初始化"><a href="#快速初始化" class="headerlink" title="快速初始化"></a>快速初始化</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span><span class="token comment" spellcheck="true"># 替换 x.x.x.x 为 master 节点实际 IP（请使用内网 IP）</span><span class="token comment" spellcheck="true"># export 命令只在当前 shell 会话中有效，开启新的 shell 窗口后，如果要继续安装过程，请重新执行此处的 export 命令</span><span class="token function">export</span> MASTER_IP<span class="token operator">=</span>x.x.x.x<span class="token comment" spellcheck="true"># 替换 apiserver.demo 为 您想要的 dnsName (不建议使用 master 的 hostname 作为 APISERVER_NAME)</span><span class="token function">export</span> APISERVER_NAME<span class="token operator">=</span>apiserver.demo<span class="token function">export</span> POD_SUBNET<span class="token operator">=</span>10.100.0.1/20<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>"</span> <span class="token operator">>></span> /etc/hostscurl -sSL https://kuboard.cn/install-script/v1.15.3/init-master.sh <span class="token operator">|</span> sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="手工初始化"><a href="#手工初始化" class="headerlink" title="手工初始化"></a>手工初始化</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span><span class="token comment" spellcheck="true"># 替换 x.x.x.x 为 master 节点实际 IP（请使用内网 IP）</span><span class="token comment" spellcheck="true"># export 命令只在当前 shell 会话中有效，开启新的 shell 窗口后，如果要继续安装过程，请重新执行此处的 export 命令</span><span class="token function">export</span> MASTER_IP<span class="token operator">=</span>x.x.x.x<span class="token comment" spellcheck="true"># 替换 apiserver.demo 为 您想要的 dnsName (不建议使用 master 的 hostname 作为 APISERVER_NAME)</span><span class="token function">export</span> APISERVER_NAME<span class="token operator">=</span>apiserver.demo<span class="token function">export</span> POD_SUBNET<span class="token operator">=</span>10.100.0.1/20<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>"</span> <span class="token operator">>></span> /etc/hosts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>手工初始化脚本</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment" spellcheck="true"># 只在 master 节点执行</span><span class="token comment" spellcheck="true"># 查看完整配置选项 https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2</span><span class="token function">rm</span> -f ./kubeadm-config.yaml<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">></span> ./kubeadm-config.yamlapiVersion: kubeadm.k8s.io/v1beta2kind: ClusterConfigurationkubernetesVersion: v1.15.3imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containerscontrolPlaneEndpoint: <span class="token string">"<span class="token variable">${APISERVER_NAME}</span>:6443"</span>networking:  serviceSubnet: <span class="token string">"10.96.0.0/12"</span>  podSubnet: <span class="token string">"<span class="token variable">${POD_SUBNET}</span>"</span>  dnsDomain: <span class="token string">"cluster.local"</span>EOF<span class="token comment" spellcheck="true"># kubeadm init</span><span class="token comment" spellcheck="true"># 根据您服务器网速的情况，您需要等候 3 - 10 分钟</span>kubeadm init --config<span class="token operator">=</span>kubeadm-config.yaml --upload-certs<span class="token comment" spellcheck="true"># 配置 kubectl</span><span class="token function">rm</span> -rf /root/.kube/<span class="token function">mkdir</span> /root/.kube/<span class="token function">cp</span> -i /etc/kubernetes/admin.conf /root/.kube/config<span class="token comment" spellcheck="true"># 安装 calico 网络插件</span><span class="token comment" spellcheck="true"># 参考文档 https://docs.projectcalico.org/v3.8/getting-started/kubernetes/</span><span class="token function">rm</span> -f calico.yaml<span class="token function">wget</span> https://docs.projectcalico.org/v3.8/manifests/calico.yaml<span class="token function">sed</span> -i <span class="token string">"s#192\.168\.0\.0/16#<span class="token variable">${POD_SUBNET}</span>#"</span> calico.yamlkubectl apply -f calico.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>检查 master 初始化结果</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span><span class="token comment" spellcheck="true"># 执行如下命令，等待 3-10 分钟，直到所有的容器组处于 Running 状态</span><span class="token function">watch</span> kubectl get pod -n kube-system -o wide<span class="token comment" spellcheck="true"># 查看 master 节点初始化结果</span>kubectl get nodes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="初始化-worker节点"><a href="#初始化-worker节点" class="headerlink" title="初始化 worker节点"></a>初始化 worker节点</h1><ul><li>获得 join命令参数</li></ul><p>在 master 节点上执行</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span><span class="token comment" spellcheck="true"># --ttl 0 创建永久的token</span>kubeadm token create --ttl 0 --print-join-command<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>可获取kubeadm join 命令及参数，如下所示</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># kubeadm token create 命令的输出</span>kubeadm <span class="token function">join</span> apiserver.demo:6443 --token nyawlj.tnbpyckkkd7tatjs     --discovery-token-ca-cert-hash sha256:022ac5a2965466ccc1c9443403e55f56d276334e761ddeef57d1148f09549c1a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="初始化worker"><a href="#初始化worker" class="headerlink" title="初始化worker"></a>初始化worker</h2><p>针对所有的 worker 节点执行</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 worker 节点执行</span><span class="token comment" spellcheck="true"># 替换 ${MASTER_IP} 为 master 节点实际 IP</span><span class="token comment" spellcheck="true"># 替换 ${APISERVER_NAME} 为初始化 master 节点时所使用的 APISERVER_NAME</span><span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>"</span> <span class="token operator">>></span> /etc/hosts<span class="token comment" spellcheck="true"># 替换为 master 节点上 kubeadm token create 命令的输出</span>kubeadm <span class="token function">join</span> apiserver.demo:6443 --token nyawlj.tnbpyckkkd7tatjs     --discovery-token-ca-cert-hash sha256:022ac5a2965466ccc1c9443403e55f56d276334e761ddeef57d1148f09549c1a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="检查初始化结果"><a href="#检查初始化结果" class="headerlink" title="检查初始化结果"></a>检查初始化结果</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span>kubectl get nodes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出结果如下所示：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@demo-master-a-1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># kubectl get nodes</span>NAME     STATUS   ROLES    AGE     VERSIONdemo-master-a-1   Ready    master   5m3s    v1.15.3demo-worker-a-1   Ready    <span class="token operator">&lt;</span>none<span class="token operator">></span>   2m26s   v1.15.3demo-worker-a-2   Ready    <span class="token operator">&lt;</span>none<span class="token operator">></span>   3m56s   v1.15.3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="移除-worker-节点"><a href="#移除-worker-节点" class="headerlink" title="移除 worker 节点"></a>移除 worker 节点</h2><p>正常情况下，您无需移除 worker 节点，如果添加到集群出错，您可以移除 worker 节点，再重新尝试添加</p><ol><li>在准备移除的 worker 节点上执行</li></ol><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 worker 节点执行</span>kubeadm reset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="2"><li>在 master 节点 demo-master-a-1 上执行</li></ol><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span>kubectl delete node demo-worker-x-x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>将 demo-worker-x-x 替换为要移除的 worker 节点的名字<br>worker 节点的名字可以通过在节点 demo-master-a-1 上执行 kubectl get nodes 命令获得</p><h1 id="安装-Ingress-Controller"><a href="#安装-Ingress-Controller" class="headerlink" title="安装 Ingress Controller"></a>安装 Ingress Controller</h1><ol><li>安装IngressController</li></ol><p><font color="red">注：</font>在 master 节点上执行</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span>kubectl apply -f https://kuboard.cn/install-script/v1.15.3/nginx-ingress.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="2"><li>卸载IngressController<br><font color="red">注：</font>在 master 节点上执行</li></ol><p>只在您想选择其他 Ingress Controller 的情况下卸载</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 只在 master 节点执行</span>kubectl delete -f https://kuboard.cn/install-script/v1.15.3/nginx-ingress.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li>YML文件</li></ol><pre class="line-numbers language-yml"><code class="language-yml"># 如果打算用于生产环境，请参考 https://github.com/nginxinc/kubernetes-ingress/blob/v1.5.3/docs/installation.md 并根据您自己的情况做进一步定制apiVersion: v1kind: Namespacemetadata:  name: nginx-ingress---apiVersion: v1kind: ServiceAccountmetadata:  name: nginx-ingress   namespace: nginx-ingress---apiVersion: v1kind: Secretmetadata:  name: default-server-secret  namespace: nginx-ingresstype: Opaquedata:  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN2akNDQWFZQ0NRREFPRjl0THNhWFhEQU5CZ2txaGtpRzl3MEJBUXNGQURBaE1SOHdIUVlEVlFRRERCWk8KUjBsT1dFbHVaM0psYzNORGIyNTBjbTlzYkdWeU1CNFhEVEU0TURreE1qRTRNRE16TlZvWERUSXpNRGt4TVRFNApNRE16TlZvd0lURWZNQjBHQTFVRUF3d1dUa2RKVGxoSmJtZHlaWE56UTI5dWRISnZiR3hsY2pDQ0FTSXdEUVlKCktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUwvN2hIUEtFWGRMdjNyaUM3QlBrMTNpWkt5eTlyQ08KR2xZUXYyK2EzUDF0azIrS3YwVGF5aGRCbDRrcnNUcTZzZm8vWUk1Y2Vhbkw4WGM3U1pyQkVRYm9EN2REbWs1Qgo4eDZLS2xHWU5IWlg0Rm5UZ0VPaStlM2ptTFFxRlBSY1kzVnNPazFFeUZBL0JnWlJVbkNHZUtGeERSN0tQdGhyCmtqSXVuektURXUyaDU4Tlp0S21ScUJHdDEwcTNRYzhZT3ExM2FnbmovUWRjc0ZYYTJnMjB1K1lYZDdoZ3krZksKWk4vVUkxQUQ0YzZyM1lma1ZWUmVHd1lxQVp1WXN2V0RKbW1GNWRwdEMzN011cDBPRUxVTExSakZJOTZXNXIwSAo1TmdPc25NWFJNV1hYVlpiNWRxT3R0SmRtS3FhZ25TZ1JQQVpQN2MwQjFQU2FqYzZjNGZRVXpNQ0F3RUFBVEFOCkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQWpLb2tRdGRPcEsrTzhibWVPc3lySmdJSXJycVFVY2ZOUitjb0hZVUoKdGhrYnhITFMzR3VBTWI5dm15VExPY2xxeC9aYzJPblEwMEJCLzlTb0swcitFZ1U2UlVrRWtWcitTTFA3NTdUWgozZWI4dmdPdEduMS9ienM3bzNBaS9kclkrcUI5Q2k1S3lPc3FHTG1US2xFaUtOYkcyR1ZyTWxjS0ZYQU80YTY3Cklnc1hzYktNbTQwV1U3cG9mcGltU1ZmaXFSdkV5YmN3N0NYODF6cFErUyt1eHRYK2VBZ3V0NHh3VlI5d2IyVXYKelhuZk9HbWhWNThDd1dIQnNKa0kxNXhaa2VUWXdSN0diaEFMSkZUUkk3dkhvQXprTWIzbjAxQjQyWjNrN3RXNQpJUDFmTlpIOFUvOWxiUHNoT21FRFZkdjF5ZytVRVJxbStGSis2R0oxeFJGcGZnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdi91RWM4b1JkMHUvZXVJTHNFK1RYZUprckxMMnNJNGFWaEMvYjVyYy9XMlRiNHEvClJOcktGMEdYaVN1eE9ycXgrajlnamx4NXFjdnhkenRKbXNFUkJ1Z1B0ME9hVGtIekhvb3FVWmcwZGxmZ1dkT0EKUTZMNTdlT1l0Q29VOUZ4amRXdzZUVVRJVUQ4R0JsRlNjSVo0b1hFTkhzbysyR3VTTWk2Zk1wTVM3YUhudzFtMApxWkdvRWEzWFNyZEJ6eGc2clhkcUNlUDlCMXl3VmRyYURiUzc1aGQzdUdETDU4cGszOVFqVUFQaHpxdmRoK1JWClZGNGJCaW9CbTVpeTlZTW1hWVhsMm0wTGZzeTZuUTRRdFFzdEdNVWozcGJtdlFmazJBNnljeGRFeFpkZFZsdmwKMm82MjBsMllxcHFDZEtCRThCay90elFIVTlKcU56cHpoOUJUTXdJREFRQUJBb0lCQVFDZklHbXowOHhRVmorNwpLZnZJUXQwQ0YzR2MxNld6eDhVNml4MHg4Mm15d1kxUUNlL3BzWE9LZlRxT1h1SENyUlp5TnUvZ2IvUUQ4bUFOCmxOMjRZTWl0TWRJODg5TEZoTkp3QU5OODJDeTczckM5bzVvUDlkazAvYzRIbjAzSkVYNzZ5QjgzQm9rR1FvYksKMjhMNk0rdHUzUmFqNjd6Vmc2d2szaEhrU0pXSzBwV1YrSjdrUkRWYmhDYUZhNk5nMUZNRWxhTlozVDhhUUtyQgpDUDNDeEFTdjYxWTk5TEI4KzNXWVFIK3NYaTVGM01pYVNBZ1BkQUk3WEh1dXFET1lvMU5PL0JoSGt1aVg2QnRtCnorNTZud2pZMy8yUytSRmNBc3JMTnIwMDJZZi9oY0IraVlDNzVWYmcydVd6WTY3TWdOTGQ5VW9RU3BDRkYrVm4KM0cyUnhybnhBb0dCQU40U3M0ZVlPU2huMVpQQjdhTUZsY0k2RHR2S2ErTGZTTXFyY2pOZjJlSEpZNnhubmxKdgpGenpGL2RiVWVTbWxSekR0WkdlcXZXaHFISy9iTjIyeWJhOU1WMDlRQ0JFTk5jNmtWajJTVHpUWkJVbEx4QzYrCk93Z0wyZHhKendWelU0VC84ajdHalRUN05BZVpFS2FvRHFyRG5BYWkyaW5oZU1JVWZHRXFGKzJyQW9HQkFOMVAKK0tZL0lsS3RWRzRKSklQNzBjUis3RmpyeXJpY05iWCtQVzUvOXFHaWxnY2grZ3l4b25BWlBpd2NpeDN3QVpGdwpaZC96ZFB2aTBkWEppc1BSZjRMazg5b2pCUmpiRmRmc2l5UmJYbyt3TFU4NUhRU2NGMnN5aUFPaTVBRHdVU0FkCm45YWFweUNweEFkREtERHdObit3ZFhtaTZ0OHRpSFRkK3RoVDhkaVpBb0dCQUt6Wis1bG9OOTBtYlF4VVh5YUwKMjFSUm9tMGJjcndsTmVCaWNFSmlzaEhYa2xpSVVxZ3hSZklNM2hhUVRUcklKZENFaHFsV01aV0xPb2I2NTNyZgo3aFlMSXM1ZUtka3o0aFRVdnpldm9TMHVXcm9CV2xOVHlGanIrSWhKZnZUc0hpOGdsU3FkbXgySkJhZUFVWUNXCndNdlQ4NmNLclNyNkQrZG8wS05FZzFsL0FvR0FlMkFVdHVFbFNqLzBmRzgrV3hHc1RFV1JqclRNUzRSUjhRWXQKeXdjdFA4aDZxTGxKUTRCWGxQU05rMXZLTmtOUkxIb2pZT2pCQTViYjhibXNVU1BlV09NNENoaFJ4QnlHbmR2eAphYkJDRkFwY0IvbEg4d1R0alVZYlN5T294ZGt5OEp0ek90ajJhS0FiZHd6NlArWDZDODhjZmxYVFo5MWpYL3RMCjF3TmRKS2tDZ1lCbyt0UzB5TzJ2SWFmK2UwSkN5TGhzVDQ5cTN3Zis2QWVqWGx2WDJ1VnRYejN5QTZnbXo5aCsKcDNlK2JMRUxwb3B0WFhNdUFRR0xhUkcrYlNNcjR5dERYbE5ZSndUeThXczNKY3dlSTdqZVp2b0ZpbmNvVlVIMwphdmxoTUVCRGYxSjltSDB5cDBwWUNaS2ROdHNvZEZtQktzVEtQMjJhTmtsVVhCS3gyZzR6cFE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=---kind: ConfigMapapiVersion: v1metadata:  name: nginx-config  namespace: nginx-ingressdata:  server-names-hash-bucket-size: "1024"---kind: ClusterRoleapiVersion: rbac.authorization.k8s.io/v1beta1metadata:  name: nginx-ingressrules:- apiGroups:  - ""  resources:  - services  - endpoints  verbs:  - get  - list  - watch- apiGroups:  - ""  resources:  - secrets  verbs:  - get  - list  - watch- apiGroups:  - ""  resources:  - configmaps  verbs:  - get  - list  - watch  - update  - create- apiGroups:  - ""  resources:  - pods  verbs:  - list- apiGroups:  - ""  resources:  - events  verbs:  - create  - patch- apiGroups:  - extensions  resources:  - ingresses  verbs:  - list  - watch  - get- apiGroups:  - "extensions"  resources:  - ingresses/status  verbs:  - update- apiGroups:  - k8s.nginx.org  resources:  - virtualservers  - virtualserverroutes  verbs:  - list  - watch  - get---kind: ClusterRoleBindingapiVersion: rbac.authorization.k8s.io/v1beta1metadata:  name: nginx-ingresssubjects:- kind: ServiceAccount  name: nginx-ingress  namespace: nginx-ingressroleRef:  kind: ClusterRole  name: nginx-ingress  apiGroup: rbac.authorization.k8s.io---apiVersion: extensions/v1beta1kind: DaemonSetmetadata:  name: nginx-ingress  namespace: nginx-ingress  annotations:    prometheus.io/scrape: "true"    prometheus.io/port: "9113"spec:  selector:    matchLabels:      app: nginx-ingress  template:    metadata:      labels:        app: nginx-ingress    spec:      serviceAccountName: nginx-ingress      containers:      - image: nginx/nginx-ingress:1.5.3        name: nginx-ingress        ports:        - name: http          containerPort: 80          hostPort: 80        - name: https          containerPort: 443          hostPort: 443        - name: prometheus          containerPort: 9113        env:        - name: POD_NAMESPACE          valueFrom:            fieldRef:              fieldPath: metadata.namespace        - name: POD_NAME          valueFrom:            fieldRef:              fieldPath: metadata.name        args:          - -nginx-configmaps=$(POD_NAMESPACE)/nginx-config          - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret         #- -v=3 # Enables extensive logging. Useful for troubleshooting.         #- -report-ingress-status         #- -external-service=nginx-ingress         #- -enable-leader-election          - -enable-prometheus-metrics         #- -enable-custom-resources<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>配置域名解析</li></ol><p>将域名 <font color="orange">*.demo.yourdomain.com </font>解析到 demo-worker-a-2 的 IP 地址 <font color="orange">z.z.z.z</font> （也可以是 demo-worker-a-1 的地址 y.y.y.y)</p><ol start="5"><li>验证配置</li></ol><p>在浏览器访问 <font color="orange">a.demo.yourdomain.com</font>，将得到 404 NotFound 错误页面</p><p><font color="red">提示</font></p><ul><li><p>许多初学者在安装 Ingress Controller 时会碰到问题，请不要灰心，可暂时跳过 安装 Ingress Controller 这个部分，等您学完 <a href="http://www.kuboard.cn" target="_blank" rel="noopener">www.kuboard.cn</a> 上 Kubernetes 入门 以及 通过互联网访问您的应用程序 这两部分内容后，再来回顾 Ingress Controller 的安装。</p></li><li><p>如果您打算将 Kubernetes 用于生产环境，请参考文档 Installing Ingress Controller，完善 Ingress 的配置</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql自动化运维工具</title>
      <link href="/mysql-zi-dong-hua-yun-wei-gong-ju/"/>
      <url>/mysql-zi-dong-hua-yun-wei-gong-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="一、简述信息"><a href="#一、简述信息" class="headerlink" title="一、简述信息"></a>一、简述信息</h1><hr><ul><li>体验地址：<a href="http://192.168.1.48:9123/" target="_blank" rel="noopener">http://192.168.1.48:9123/</a></li><li>用户信息</li></ul><table><thead><tr><th align="center">角色</th><th align="center">账号</th><th align="center">密码</th></tr></thead><tbody><tr><td align="center">管理员</td><td align="center">admin</td><td align="center">admin</td></tr><tr><td align="center">工程师</td><td align="center">engineer</td><td align="center">archer</td></tr><tr><td align="center">审核人</td><td align="center">auditor</td><td align="center">archer</td></tr><tr><td align="center">DBA</td><td align="center">dba</td><td align="center">auditor</td></tr></tbody></table><ul><li>docker 地址分别如下<pre class="line-numbers language-html"><code class="language-html">registry.cn-beijing.aliyuncs.com/hooyh_public/inceptionregistry.cn-beijing.aliyuncs.com/hooyh_public/archer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><h1 id="二、安装docker以及启动inception、MySQL和archer"><a href="#二、安装docker以及启动inception、MySQL和archer" class="headerlink" title="二、安装docker以及启动inception、MySQL和archer"></a>二、安装docker以及启动inception、MySQL和archer</h1><hr><ol><li>安装</li></ol><pre class="line-numbers language-bash"><code class="language-bash">yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repoyum makecache fastyum -y <span class="token function">install</span> docker-ce<span class="token comment" spellcheck="true">#启动服务并设置开机启动</span>systemctl <span class="token function">enable</span> docker <span class="token operator">&amp;&amp;</span> systemctl start docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>pull所需镜像</li></ol><pre class="line-numbers language-bash"><code class="language-bash">docker pull registry.cn-beijing.aliyuncs.com/hooyh_public/archerdocker pull registry.cn-beijing.aliyuncs.com/hooyh_public/inception<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>下载完之后docker images查看镜像</p><p><img src="img/image001.png" alt="avatar"></p><ol start="3"><li>创建配置文件/etc/inc.cnf</li></ol><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">>></span>/etc/inc.cnf<span class="token operator">&lt;&lt;</span><span class="token string">EOF[inception]general_log=1general_log_file=inception.logport=6669socket=/tmp/inc.socketcharacter-set-client-handshake=0character-set-server=utf8#备份库信息inception_remote_system_password=123456inception_remote_system_user=rootinception_remote_backup_port=3306inception_remote_backup_host=mysqlinception_support_charset=utf8,utf8mb4inception_enable_nullable=0inception_check_primary_key=1inception_check_column_comment=1inception_check_table_comment=1inception_osc_on=OFFinception_osc_bin_dir=/usr/bininception_osc_min_table_size=1inception_osc_chunk_time=0.1inception_enable_blob_type=1inception_check_column_default_value=1EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>启动inception</li></ol><p>指定配置文件和端口</p><pre class="line-numbers language-bash"><code class="language-bash">docker run --name inception -v ~/data/inception/inc.cnf:/etc/inc.cnf -p 6669:6669 -dti registry.cn-beijing.aliyuncs.com/hooyh_public/inception<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>启动MySQL5.7镜像</li></ol><pre class="line-numbers language-bash"><code class="language-bash">docker run -d --name mysql   -p 3306:3306 -v ~/data/mysql:/var/lib/mysql:rw  -e MYSQL_ROOT_PASSWORD<span class="token operator">=</span>123456 -d mysql:5.7.22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="6"><li>配置archer</li></ol><p>安装完毕之后  创建django初始化的settings.py<br>红色标注为需要根据自身服务器修改的地方   如果出现报错 注意配置中间是否有多余空行</p><p><a href="https://github.com/Hooyh110/DevOps/blob/master/mysql/Automation-operation/archer/settings.py" target="_blank" rel="noopener">settings.py</a></p><ol start="7"><li>创建一个archer_github数据库</li></ol><p>我用的编码格式为 utf8mb4_bin</p><pre class="line-numbers language-mysql"><code class="language-mysql">CREATE DATABASE `archer_github` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="img/image002.png" alt="avatar"></p><p>不创建数据库初始化会报如下错误</p><p><img src="img/image003.png" alt="avatar"></p><p>在mysql中执行如下sql否则回滚sql时 会提示inception账号的一系列问题哦</p><pre class="line-numbers language-mysql"><code class="language-mysql">grant all privileges on *.* to 'inception'@'%' identified by 'inception' with grant option;flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="img/image004.png" alt="avatar"></p><p>创建完数据库之后运行容器</p><pre class="line-numbers language-bash"><code class="language-bash">docker run --name archer -e NGINX_PORT<span class="token operator">=</span>9123 -p 9123:9123 --link mysql:mysql --link inception:inception -dti registry.cn-beijing.aliyuncs.com/hooyh_public /archer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="8"><li>进入archer容器执行初始化命令</li></ol><pre class="line-numbers language-bash"><code class="language-bash">docker <span class="token function">exec</span> -ti archer /bin/bash<span class="token function">cd</span> /opt/archer<span class="token function">source</span> /opt/venv4archer/bin/activate<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>修改 archer/settings.py修改其中数据库的地址及账号密码否则makemigrations会报错<br><img src="img/image005.png" alt="avatar"></p><p><img src="img/image006.png" alt="avatar"></p><pre class="line-numbers language-bash"><code class="language-bash">python3 manage.py makemigrations sql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="img/image007.png" alt="avatar"></p><pre class="line-numbers language-bash"><code class="language-bash">python3 manage.py migrate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="img/image008.png" alt="avatar"></p><p>创建管理员账号</p><pre class="line-numbers language-bash"><code class="language-bash">python3 manage.py createsuperuseradmin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>创建完毕后，退出并重启该archer容器，让其用户生效<br> 查看容器状态</p><p><img src="img/image009.png" alt="avatar"></p><ol start="9"><li>关闭防火墙或添加防火墙规则访问</li></ol><p><font color="red"><a href="http://127.0.0.1:9123" target="_blank" rel="noopener">http://127.0.0.1:9123</a></font></p><h1 id="三-、登录系统配置及验证"><a href="#三-、登录系统配置及验证" class="headerlink" title="三 、登录系统配置及验证"></a>三 、登录系统配置及验证</h1><hr><ol><li>发布sql工单流程</li></ol><p>普通用户登录<a href="http://127.0.0.1:9123" target="_blank" rel="noopener">http://127.0.0.1:9123</a></p><p><img src="img/image010.png" alt="avatar"></p><p>输入你要执行的sql</p><p><img src="img/image011.png" alt="avatar"></p><p><img src="img/image012.png" alt="avatar"></p><p>审批人账号收到邮件</p><p><img src="img/image013.png" alt="avatar"></p><p>用审批人账号登录</p><p><img src="img/image014.png" alt="avatar"></p><p>审核通过</p><p><img src="img/image015.png" alt="avatar"></p><p><img src="img/image016.png" alt="avatar"></p><p>DBA账号收到邮件</p><p>用DBA账号登录</p><p>执行</p><p><img src="img/image017.png" alt="avatar"></p><p>回滚同理</p><p><img src="img/image018.png" alt="avatar"></p><p><img src="img/image019.png" alt="avatar"></p><ol start="2"><li>配置阿里云RDS</li></ol><p>如果需要加入阿里云RDS修改配置文件settings.py</p><p><img src="img/image020.png" alt="avatar"></p><p>也可以加上邮件通知</p><p><img src="img/image021.png" alt="avatar"></p><p>重启archer 的docker服务 就可以了</p><p><img src="img/image022.png" alt="avatar"></p><ol start="3"><li>测试回滚功能</li></ol><p><img src="img/image023.png" alt="avatar"></p><p>审核并执行</p><p><img src="img/image024.png" alt="avatar"></p><p>执行成功</p><p><img src="img/image025.png" alt="avatar"></p><p>查看数据库中备份</p><p><img src="img/image026.png" alt="avatar"></p><p>提交回滚请求 需要检测之后提交</p><p><img src="img/image027.png" alt="avatar"></p><p><img src="img/image028.png" alt="avatar"></p><p><img src="img/image029.png" alt="avatar"></p><p>切换dba账户执行回滚</p><p><img src="img/image030.png" alt="avatar"></p><p>回滚成功</p><p><img src="img/image031.png" alt="avatar"></p><p>邮件也收到，只不过我为了测试邮件通知人都是自己</p><p>需要修改的话直接在后台数据管理中修改</p><p><img src="img/image032.png" alt="avatar"></p><ol start="4"><li>数据库名称</li></ol><p>如果数据库名太长的话 会报错</p><pre class="line-numbers language-html"><code class="language-html">Global environment  errorThe backup dbname 'rm-bp1570xxxfo.mysql.rds.aliyuncs.com-3306- lse_home_prod ' is too long.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="img/image033.png" alt="avatar"></p><p>原因是RDS库名+端口+数据库名太长，超过了mysql 的information_schema中字段的值64</p><p>所以库名不要超过11字节就不会报上述错误了(sql错误请忽略我就是拿来演示的)</p><p><img src="img/image034.png" alt="avatar"></p><p>要不就ping一下阿里云的RDS地址  把RDS地址换成ip即可</p><p>在工单界面 也是看不到具体ip的</p><p><img src="img/image035.png" alt="avatar"></p><p><img src="img/image036.png" alt="avatar"></p><ol start="5"><li><p>配置访问地址为80访问</p></li><li><p>再安装一个80端口的nginx  解析到docker的9123的nginx 端口</p></li><li><p>只需要添加下面一条设置即可</p></li></ol><p><img src="img/image037.png" alt="avatar"></p><p><img src="img/image038.png" alt="avatar"></p><ol start="8"><li>防火墙配置</li></ol><p>把9123 80 3306 6669端口加入防火墙  并reload</p><pre class="line-numbers language-bash"><code class="language-bash">firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>80/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>9123/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>3306/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>6669/tcp --permanentfirewall-cmd --reload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果你的sql 比较大，可能会报错</p><p><img src="img/image039.png" alt="avatar"></p><p>修改archer 容器里nginx配置中client_max_body_size 设置大一点就可以了</p><p><img src="img/image040.png" alt="avatar"></p><ol start="9"><li>配置LDAP</li></ol><p>加入ldap    由于之前搭建的服务器是没有介入内网ldap的  配置ldap的时候就一模一样再装了一遍</p><p>ldap配置可参考<a href="https://www.cnblogs.com/chenminklutz/p/9642277.html" target="_blank" rel="noopener">https://www.cnblogs.com/chenminklutz/p/9642277.html</a><br>不过我的ou带有空格 cn带有空格所以自己重新配置了用“”把字段括起来了<br>红色框框处需要自行根据ou进行修改</p><p><img src="img/image041.png" alt="avatar"></p><p>可以先安装ldapsearch测试</p><pre class="line-numbers language-bash"><code class="language-bash">yum <span class="token function">install</span> -y openldap-servers openldap-clients migrationtoolsldapsearch -x -W -h  172.16.5.1 -p 389 -b <span class="token string">"dc=tiansoft,dc=com"</span> -D <span class="token string">"cn=Jiamin Xu(Hugo),ou=FTE,ou=Domain Users,dc=tiansoft,dc=com"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="img/image042.png" alt="avatar"></p><p>至此mysql自动化运维平台已经搭建完毕  配置方面请根据个人需求配置。</p>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务器脑裂</title>
      <link href="/fu-wu-qi-nao-lie/"/>
      <url>/fu-wu-qi-nao-lie/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> news </category>
          
      </categories>
      
      
        <tags>
            
            <tag> news </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分布式系统 - 雪崩效应</title>
      <link href="/fen-bu-shi-xi-tong-xue-beng-xiao-ying/"/>
      <url>/fen-bu-shi-xi-tong-xue-beng-xiao-ying/</url>
      
        <content type="html"><![CDATA[<h1 id="雪崩效应现象"><a href="#雪崩效应现象" class="headerlink" title=" 雪崩效应现象"></a><font color="blue"> 雪崩效应现象</font></h1><blockquote><p>参考资料：<br>    <a href="https://github.com/Netflix/Hystrix/wiki" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix/wiki</a><br>    <a href="https://www.jianshu.com/p/83a99e183fa5" target="_blank" rel="noopener">https://www.jianshu.com/p/83a99e183fa5</a></p></blockquote><p>&emsp;复杂分布式架构的应用程序有许多依赖，其中每一个在某些时候都会不可避免的发生失败。如果这个主应用没有从那些外部失败隔离，那么就会有被拖垮的风险。</p><p>例如，1个应用依赖30个服务，每个服务有99.99%可用，那么预期：</p><pre><code>99.9930 = 99.7％的正常运行时间10亿次请求中有0.3％= 3,000,000次失败2小时停机时间/月，即使所有的依赖都有很好的正常运行时间</code></pre><p>现实通常会更残酷。</p><p>&emsp;如果你没有针对整个系统做快速恢复，即使所有依赖只有 0.01% 的不可用率，累积起来每个月给系统带来的不可用时间也有数小时之多。</p><p>当一切都ok的请求流看起来是这样的：<br><img src="img/1.png" width="600" height="600"><br>当许多后端系统中的一个成为潜在故障时，可能会阻塞所有用户请求：<br><img src="img/2.png" width="600" height="600"><br>一个高并发后端依赖成为潜在危险时，它会在几秒钟中导致所有服务器上的所有的资源耗尽。</p><p>&emsp;在网络中或者客户端库中运行的每一个app都有可能会导致成为潜在的故障源。比失败更坏的是，这个问题app也可能会导致服务之间的延迟增加，从而备份队列，线程，和其他系统资源，导致更多系统的级联故障。<br><img src="img/3.png" width="600" height="600"><br>&emsp;当通过第三方客户端网络访问时，这些问题会加剧，这个第三方客户端就是一个黑盒，其实现细节是不清楚的，它能随时改变行为，每个客户端的网络和资源配置是不同的，通常难以监控和修改。</p><p>&emsp;如果这些网络请求通过第三方客户端发出，问题会变得更加严重，因为这些第三方客户端对于应用来说相当于《黑盒》—无法了解其实现细节，随时可能发生变更，网络/资源配置随客户端的不通而不同，同时又难以监控和修改。同时，应用依赖链中的服务可能非常耗时，或者这些可能导致问题的网络请求根本没有被我们的应用显示的调用！</p><p>&emsp;网络连接可能失败或者降级。服务或者服务器可能失效或者变慢。新依赖的库或者部署的服务可能改变行为或性能，亦或是依赖的客户端库本身有bug。</p><p>&emsp;所有以上这些所描述的失败和延迟都需要被隔离和管理，才不至于因为单个服务失败而导致整个应用活系统垮掉。</p><p>&emsp;上面是Hystrix文档中给我们描述的在多服务系统中由于某个服务的不可用从而会导致整个系统不可用的一种现象。</p><p>&emsp;简单的来说就是由于服务提供者A不可用，导致服务调用者B对A的请求阻塞，没有相关的机制通知或解决请求阻塞，导致在服务调用者B对A请求的阻塞越来越多，阻塞请求变多并且不断对A进行请求重试导致服务调用者B所在的系统的资源会被耗尽，而服务调用者B所在的系统可能并不会只有对A的调用，还有存在对其他服务提供者的调用，因为调用A把系统资源已经耗尽了，导致也无法处理对非A请求，而且这种不可用可能沿请求调用链向上传递，比如说服务调用者C会调用B的服务，因为B所在的系统不可用，导致C也不可用，这样级联导致阻塞请求越来越多，表现为多个系统都不可用了，这种现象被称为”雪崩效应”。</p><hr><blockquote><p><font color="orange" size="6">以下内容为互联网资源整理</font></p></blockquote><h1 id="雪崩效应产生的原因"><a href="#雪崩效应产生的原因" class="headerlink" title="雪崩效应产生的原因"></a><font color="blue">雪崩效应产生的原因</font></h1><p>&emsp;根据上面的描述，概括一下雪崩效应的过程：服务提供者不可用-&gt;服务调用者请求重试-&gt;服务调用者所在的系统资源耗尽，服务调用者不可用。</p><p>这个过程再概括一下分为三个阶段：</p><ol><li>服务提供者不可用</li><li>服务调用者重试</li><li>服务调用者不可用</li></ol><p>服务雪崩的每个阶段都可能由不同的原因造成，下面逐一说明。</p><p>服务提供者不可用</p><p>服务提供者不可用产生的原因可能有以下几点：</p><ul><li>硬件故障<br>如服务器宕机，机房断电，光纤被挖断等。</li><li>程序Bug<br>如程序逻辑导致内存泄漏，JVM长时间FullGC等。</li><li>缓存击穿<br>缓存击穿一般发生在缓存应用重启, 所有缓存被清空时,以及短时间内大量缓存失效时. 大量的缓存不命中, 使请求直击后端,造成服务提供者超负荷运行,引起服务不可用.</li><li>流量激增<br>流量激增导致服务提供者无法承受这样的高负载，激增的原因有异常流量，重试加大流量等。</li></ul><p><strong>服务调用者重试</strong></p><p>在服务提供者出现不可用的情况下，服务调用者重试加大了流量，服务调用者重试又可以分为两种：</p><ul><li>用户重试<br>在服务提供者不可用后，用户由于忍受不了界面上长时间的等待，而不断刷新页面甚至提交表单。</li><li>代码逻辑重试<br>在代码中请求远端服务时，在出现请求异常的时候，代码逻辑都会有重试的功能，这在因为网路抖动导致请求超时的情况下是很有用的。但是如果本身服务提供者就不可用了，这种不断地重试会加大对服务器提供者的请求流量。</li></ul><p><strong>服务调用者不可用</strong></p><p>服务调用者不可用产生的原因主要是：</p><ul><li>同步等待造成的资源耗尽</li></ul><p>&emsp;当服务调用者使用同步调用时, 会产生大量的等待线程占用系统资源。一旦线程资源被耗尽，服务调用者提供的服务也将处于不可用状态。</p><h1 id="雪崩效应应对策略"><a href="#雪崩效应应对策略" class="headerlink" title="雪崩效应应对策略"></a><font color="blue">雪崩效应应对策略</font></h1><p>应对策略从造成雪崩的原因出发，提供不同的原因下的解决方案。</p><ul><li>硬件故障：多机房容灾、异地多活等。</li><li>程序BUG：修改程序bug、及时释放资源等。</li><li>缓存穿透：缓存预加载、缓存异步加载等。</li><li>流量激增：服务自动扩容、流量控制（限流、关闭重试）等。</li><li>同步等待：资源隔离、MQ解耦、不可用服务调用快速失败等。资源隔离通常指不同服务调用采用不同的线程池；不可用服务调用快速失败一般通过熔断器模式结合超时机制实现。</li></ul><p>总结一下就是几个关键词：扩容、流控（流量控制）、隔离、熔断。</p>]]></content>
      
      
      <categories>
          
          <category> news </category>
          
      </categories>
      
      
        <tags>
            
            <tag> news </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见error及解决方法</title>
      <link href="/chang-jian-error-ji-jie-jue-fang-fa/"/>
      <url>/chang-jian-error-ji-jie-jue-fang-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="Python-系列："><a href="#Python-系列：" class="headerlink" title="Python 系列： "></a><font color="blue">Python 系列： </font></h1><ol><li>使用execjs 解析抓取的网页数据时<font color="red"><strong>错误：</strong>Could not find an available JavaScript runtime </font></li></ol><ul><li>解决方法：</li></ul><pre class="line-numbers language-bash"><code class="language-bash">pip3 <span class="token function">install</span> PyExecJSyum <span class="token function">install</span> -y nodejs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="Linux-系列："><a href="#Linux-系列：" class="headerlink" title="Linux 系列： "></a><font color="blue">Linux 系列： </font></h1><h1 id="docker-系列："><a href="#docker-系列：" class="headerlink" title="docker 系列： "></a><font color="blue">docker 系列： </font></h1><h1 id="nginx-系列："><a href="#nginx-系列：" class="headerlink" title="nginx 系列： "></a><font color="blue">nginx 系列： </font></h1><h1 id="mysql-系列："><a href="#mysql-系列：" class="headerlink" title="mysql 系列： "></a><font color="blue">mysql 系列： </font></h1><ol><li><p>mysql远程连接报错 <font color="red">ERROR 1129 (HY000): Host ‘192.168.7.210’ is blocked because of many connection errors; unblock with ‘mysqladmin flush-hosts’</font></p><ul><li><p>问题原因<br>一般<font color="Orange">max_connect_errors = 10</font>，要调高错误连接的数量</p></li><li><p>解决方法</p></li></ul></li></ol><p>登录到要连接的数据中，进行如下配置</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> show variables like 'max_connect_errors';mysql> set global max_connect_errors = 1000;# 如果想长期生效，并修改my.cnf配置文件mysql> flush hosts;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="redis-系列："><a href="#redis-系列：" class="headerlink" title="redis 系列： "></a><font color="blue">redis 系列： </font></h1><h1 id="hadoop-系列："><a href="#hadoop-系列：" class="headerlink" title="hadoop 系列： "></a><font color="blue">hadoop 系列： </font></h1>]]></content>
      
      
      <categories>
          
          <category> Error </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Error </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo 博客编写</title>
      <link href="/hexo-bo-ke-bian-xie/"/>
      <url>/hexo-bo-ke-bian-xie/</url>
      
        <content type="html"><![CDATA[<h1 id="修改title显示"><a href="#修改title显示" class="headerlink" title="修改title显示"></a><font face="黑体" color="blue" size="6">修改title显示</font></h1><ul><li>修改主题中layout.ejs文件</li><li><ul><li>文件路径：<font color="GoldenRod">themes/matery/layout/layout.ejs</font></li></ul></li></ul><p>修改如下内容：<br><font color="GoldenRod">document.title = “welcome to helen blog” </font> 双引号中的内容替换成你自己想要的</p><pre class="line-numbers language-js"><code class="language-js">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span> <span class="token keyword">var</span> OriginTitile <span class="token operator">=</span> document<span class="token punctuation">.</span>title<span class="token punctuation">,</span> st<span class="token punctuation">;</span> document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"visibilitychange"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> document<span class="token punctuation">.</span>hidden <span class="token operator">?</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"welcome to helen blog"</span><span class="token punctuation">,</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Angel of justice"</span><span class="token punctuation">,</span> st <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> document<span class="token punctuation">.</span>title <span class="token operator">=</span> OriginTitile <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3e3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>效果</strong><br><img src="img/title.png"></p><h1 id="博客增加音乐"><a href="#博客增加音乐" class="headerlink" title="博客增加音乐"></a><font face="黑体" color="green" size="6">博客增加音乐</font></h1><h2 id="修改主页音乐播放器音乐"><a href="#修改主页音乐播放器音乐" class="headerlink" title="修改主页音乐播放器音乐"></a>修改主页音乐播放器音乐</h2><ul><li>修改 <font color="GoldenRod">source/_data/musics.json</font>文件，根据以下内容修改成你自己的</li><li><font color="red">注意：音乐文件需要提前下载并放入到/medias/music/目录下</font></li></ul><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">[</span>    <span class="token punctuation">{</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"GO Time"</span><span class="token punctuation">,</span>        <span class="token property">"artist"</span><span class="token operator">:</span> <span class="token string">"Mark petrie"</span><span class="token punctuation">,</span>        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"/medias/music/gotime.mp3"</span><span class="token punctuation">,</span>        <span class="token property">"cover"</span><span class="token operator">:</span> <span class="token string">"/medias/music/avatars/yequ.jpg"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"风的季节"</span><span class="token punctuation">,</span>        <span class="token property">"artist"</span><span class="token operator">:</span> <span class="token string">"Soler"</span><span class="token punctuation">,</span>        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"/medias/music/soler.mp3"</span><span class="token punctuation">,</span>        <span class="token property">"cover"</span><span class="token operator">:</span> <span class="token string">"/medias/music/avatars/yequ.jpg"</span>    <span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>效果</strong><img src="img/homepage.png"></li></ul><h2 id="添加网易云音乐BGM"><a href="#添加网易云音乐BGM" class="headerlink" title="添加网易云音乐BGM"></a><font color="green">添加网易云音乐BGM</font></h2><p>写文章的时候，想插入一段BGM怎么办？</p><p>首先打开网易云网页版，找到想听的歌曲，然后点击生成外链：</p><img src="img/music01.png"><p>复制如下代码：</p><img src="img/music02.png"><p>粘贴到文章里就行了，为了美观，设置一下居中，具体代码如下：</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>这里粘贴刚刚复制的代码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="添加百度统计和谷歌统计代码"><a href="#添加百度统计和谷歌统计代码" class="headerlink" title="添加百度统计和谷歌统计代码"></a><font color="blue">添加百度统计和谷歌统计代码</font></h1><p>首先打开<a href="https://ziyuan.baidu.com/" target="_blank" rel="noopener">百度站长平台</a>，然后点击添加网站，输入网址并选择领域。</p><p>接下来要验证网站所有权，有三种方式，推荐采用HTML标签验证，最简单，将代码复制出来。</p><p>打开themes/matery/layout/_partial/head.ejs，修改下面两行：</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>baidu-site-verification<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>google-site-verification<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>其中content内容改成你自己刚刚复制出来的就行了。</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown常用方法</title>
      <link href="/markdown-chang-yong-zi-ti-yan-se-lie-biao/"/>
      <url>/markdown-chang-yong-zi-ti-yan-se-lie-biao/</url>
      
        <content type="html"><![CDATA[<p>Markdown 通过简单标记语法，使普通文本内容具有一定格式。但它本身不支持修改字体、字号与颜色等功能的。</p><h1 id="字体设置"><a href="#字体设置" class="headerlink" title="字体设置"></a>字体设置</h1><p>加粗</p><p>要加粗的文字左右分别用两个*号包起来</p><p>斜体</p><p>要倾斜的文字左右分别用一个*号包起来</p><p>斜体加粗</p><p>要倾斜和加粗的文字左右分别用三个*号包起来</p><p>删除线</p><p>要加删除线的文字左右分别用两个~~号包起来</p><p><strong>示例：</strong></p><pre class="line-numbers language-html"><code class="language-html">**这是加粗的文字***这是倾斜的文字*`***这是斜体加粗的文字***~~这是加删除线的文字~~<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>效果</strong></p><p><strong>这是加粗的文字</strong><br><em>这是倾斜的文字</em>`<br><strong><em>这是斜体加粗的文字</em></strong><br><del>这是加删除线的文字</del></p><h1 id="句首缩进"><a href="#句首缩进" class="headerlink" title="句首缩进"></a>句首缩进</h1><pre class="line-numbers language-html"><code class="language-html">半方大的空白 <span class="token entity" title="&ensp;">&amp;ensp;</span>  或 <span class="token entity" title="&#8194;">&amp;#8194;</span>全方大的空白 <span class="token entity" title="&emsp;">&amp;emsp;</span> 或 <span class="token entity" title="&#8195;">&amp;#8195;</span>不断行的空白格 <span class="token entity" title="&nbsp;">&amp;nbsp;</span> 或 <span class="token entity" title="&#160;">&amp;#160;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="设置文字字体大小及颜色"><a href="#设置文字字体大小及颜色" class="headerlink" title="设置文字字体大小及颜色"></a>设置文字字体大小及颜色</h1><ul><li>样例：<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span>red</span> <span class="token attr-name">face</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>黑体<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是黑体字<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">face</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>黑体<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是黑体字<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">face</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>微软雅黑<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是微软雅黑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">face</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>STCAIYUN<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是华文彩云<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span>black</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span>4</span> <span class="token attr-name">face</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>黑体<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>黑体<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span>#00ffff</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span>3</span><span class="token punctuation">></span></span>null<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span>gray</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span>5</span><span class="token punctuation">></span></span>gray<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>  <font color="red" face="黑体">我是黑体字</font><br>  <font face="黑体">我是黑体字</font><br>  <font face="微软雅黑">我是微软雅黑</font><br>  <font face="STCAIYUN">我是华文彩云</font><br>  <font color="black" size="4" face="黑体">黑体</font><br>  <font color="#00ffff" size="3">null</font><br>  <font color="gray" size="5">gray</font></li></ul><h1 id="设置文字背景颜色"><a href="#设置文字背景颜色" class="headerlink" title="设置文字背景颜色"></a>设置文字背景颜色</h1><p><code>&lt;table&gt;&lt;tr&gt;&lt;td bgcolor=yellow&gt; 注意：我的背景颜色是黄色。&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</code><br>    <table><tr><td bgcolor="yellow"> 注意：我的背景颜色是黄色。</td></tr></table></p><h1 id="设置单元格背景颜色"><a href="#设置单元格背景颜色" class="headerlink" title="设置单元格背景颜色"></a>设置单元格背景颜色</h1><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>方法说明<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>颜色名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>颜色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Hotpink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>此处实现方法利用 CSDN-markdown 内嵌 html 语言的优势<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Hotpink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hotpink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Hotpink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>rgb(240, 248, 255)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>借助 table, tr, td 等表格标签的 bgcolor 属性实现背景色设置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>AntiqueWhite<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pink<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>rgb(255, 192, 203)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><tbody>    <tr>        <th>方法说明</th><th>颜色名称</th><th>颜色</th>    </tr>    <tr>        <td><font color="Hotpink">此处实现方法利用 CSDN-markdown 内嵌 html 语言的优势</font></td><td><font color="Hotpink">Hotpink</font></td><td bgcolor="Hotpink">rgb(240, 248, 255)</td>    </tr>    <tr>        <td><font color="Pink">借助 table, tr, td 等表格标签的 bgcolor 属性实现背景色设置</font></td><td><font color="pink">AntiqueWhite</font></td><td bgcolor="Pink">rgb(255, 192, 203)</td>    </tr></tbody></table><hr><h1 id="颜色列表"><a href="#颜色列表" class="headerlink" title="颜色列表"></a><font face="黑体" color="green" size="6">颜色列表</font></h1><table><tbody>    <tr>        <th>颜色名</th><th>十六进制颜色值</th><th>颜色</th>    </tr>    <tr>        <td><font color="AliceBlue">AliceBlue</font></td><td><font color="AliceBlue">#F0F8FF</font></td><td bgcolor="AliceBlue">rgb(240, 248, 255)</td>    </tr>    <tr>        <td><font color="AntiqueWhite">AntiqueWhite</font></td><td><font color="AntiqueWhite">#FAEBD7</font></td><td bgcolor="AntiqueWhite">rgb(250, 235, 215)</td>    </tr>    <tr>        <td><font color="Aqua">Aqua</font></td><td><font color="Aqua">#00FFFF</font></td><td bgcolor="Aqua">rgb(0, 255, 255)</td>    </tr>    <tr>        <td><font color="Aquamarine">Aquamarine</font></td><td><font color="Aquamarine">#7FFFD4</font></td><td bgcolor="Aquamarine">rgb(127, 255, 212)</td>    </tr>    <tr>        <td><font color="Azure">Azure</font></td><td><font color="Azure">#F0FFFF</font></td><td bgcolor="Azure">rgb(240, 255, 255)</td>    </tr>    <tr>        <td><font color="Beige">Beige</font></td><td><font color="Beige">#F5F5DC</font></td><td bgcolor="Beige">rgb(245, 245, 220)</td>    </tr>    <tr>        <td><font color="Bisque">Bisque</font></td><td><font color="Bisque">#FFE4C4</font></td><td bgcolor="Bisque">rgb(255, 228, 196)</td>    </tr>    <tr>        <td><font color="Black">Black</font></td><td><font color="Black">#000000</font></td><td bgcolor="Black">rgb(0, 0, 0)</td>    </tr>    <tr>        <td><font color="BlanchedAlmond">BlanchedAlmond</font></td><td><font color="BlanchedAlmond">#FFEBCD</font></td><td bgcolor="BlanchedAlmond">rgb(255, 235, 205)</td>    </tr>    <tr>        <td><font color="Blue">Blue</font></td><td><font color="Blue">#0000FF</font></td><td bgcolor="Blue">rgb(0, 0, 255)</td>    </tr>    <tr>        <td><font color="BlueViolet">BlueViolet</font></td><td><font color="BlueViolet">#8A2BE2</font></td><td bgcolor="BlueViolet">rgb(138, 43, 226)</td>    </tr>    <tr>        <td><font color="Brown">Brown</font></td><td><font color="Brown">#A52A2A</font></td><td bgcolor="Brown">rgb(165, 42, 42)</td>    </tr>    <tr>        <td><font color="BurlyWood">BurlyWood</font></td><td><font color="BurlyWood">#DEB887</font></td><td bgcolor="BurlyWood">rgb(222, 184, 135)</td>    </tr>    <tr>        <td><font color="CadetBlue">CadetBlue</font></td><td><font color="CadetBlue">#5F9EA0</font></td><td bgcolor="CadetBlue">rgb(95, 158, 160)</td>    </tr>    <tr>        <td><font color="Chartreuse">Chartreuse</font></td><td><font color="Chartreuse">#7FFF00</font></td><td bgcolor="Chartreuse">rgb(127, 255, 0)</td>    </tr>    <tr>        <td><font color="Chocolate">Chocolate</font></td><td><font color="Chocolate">#D2691E</font></td><td bgcolor="Chocolate">rgb(210, 105, 30)</td>    </tr>    <tr>        <td><font color="Coral">Coral</font></td><td><font color="Coral">#FF7F50</font></td><td bgcolor="Coral">rgb(255, 127, 80)</td>    </tr>    <tr>        <td><font color="CornflowerBlue">CornflowerBlue</font></td><td><font color="CornflowerBlue">#6495ED</font></td><td bgcolor="CornflowerBlue">rgb(100, 149, 237)</td>    </tr>    <tr>        <td><font color="Cornsilk">Cornsilk</font></td><td><font color="Cornsilk">#FFF8DC</font></td><td bgcolor="Cornsilk">rgb(255, 248, 220)</td>    </tr>    <tr>        <td><font color="Crimson">Crimson</font></td><td><font color="Crimson">#DC143C</font></td><td bgcolor="Crimson">rgb(220, 20, 60)</td>    </tr>    <tr>        <td><font color="Cyan">Cyan</font></td><td><font color="Cyan">#00FFFF</font></td><td bgcolor="Cyan">rgb(0, 255, 255)</td>    </tr>    <tr>        <td><font color="DarkBlue">DarkBlue</font></td><td><font color="DarkBlue">#00008B</font></td><td bgcolor="DarkBlue">rgb(0, 0, 139)</td>    </tr>    <tr>        <td><font color="DarkCyan">DarkCyan</font></td><td><font color="DarkCyan">#008B8B</font></td><td bgcolor="DarkCyan">rgb(0, 139, 139)</td>    </tr>    <tr>        <td><font color="DarkGoldenRod">DarkGoldenRod</font></td><td><font color="DarkGoldenRod">#B8860B</font></td><td bgcolor="DarkGoldenRod">rgb(184, 134, 11)</td>    </tr>    <tr>        <td><font color="DarkGray">DarkGray</font></td><td><font color="DarkGray">#A9A9A9</font></td><td bgcolor="DarkGray">rgb(169, 169, 169)</td>    </tr>    <tr>        <td><font color="DarkGreen">DarkGreen</font></td><td><font color="DarkGreen">#006400</font></td><td bgcolor="DarkGreen">rgb(0, 100, 0)</td>    </tr>    <tr>        <td><font color="DarkKhaki">DarkKhaki</font></td><td><font color="DarkKhaki">#BDB76B</font></td><td bgcolor="DarkKhaki">rgb(189, 183, 107)</td>    </tr>    <tr>        <td><font color="DarkMagenta">DarkMagenta</font></td><td><font color="DarkMagenta">#8B008B</font></td><td bgcolor="DarkMagenta">rgb(139, 0, 139)</td>    </tr>    <tr>        <td><font color="DarkOliveGreen">DarkOliveGreen</font></td><td><font color="DarkOliveGreen">#556B2F</font></td><td bgcolor="DarkOliveGreen">rgb(85, 107, 47)</td>    </tr>    <tr>        <td><font color="Darkorange">Darkorange</font></td><td><font color="Darkorange">#FF8C00</font></td><td bgcolor="Darkorange">rgb(255, 140, 0)</td>    </tr>    <tr>        <td><font color="DarkOrchid">DarkOrchid</font></td><td><font color="DarkOrchid">#9932CC</font></td><td bgcolor="DarkOrchid">rgb(153, 50, 204)</td>    </tr>    <tr>        <td><font color="DarkRed">DarkRed</font></td><td><font color="DarkRed">#8B0000</font></td><td bgcolor="DarkRed">rgb(139, 0, 0)</td>    </tr>    <tr>        <td><font color="DarkSalmon">DarkSalmon</font></td><td><font color="DarkSalmon">#E9967A</font></td><td bgcolor="DarkSalmon">rgb(233, 150, 122)</td>    </tr>    <tr>        <td><font color="DarkSeaGreen">DarkSeaGreen</font></td><td><font color="DarkSeaGreen">#8FBC8F</font></td><td bgcolor="DarkSeaGreen">rgb(143, 188, 143)</td>    </tr>    <tr>        <td><font color="DarkSlateBlue">DarkSlateBlue</font></td><td><font color="DarkSlateBlue">#483D8B</font></td><td bgcolor="DarkSlateBlue">rgb(72, 61, 139)</td>    </tr>    <tr>        <td><font color="DarkSlateGray">DarkSlateGray</font></td><td><font color="DarkSlateGray">#2F4F4F</font></td><td bgcolor="DarkSlateGray">rgb(47, 79, 79)</td>    </tr>    <tr>        <td><font color="DarkTurquoise">DarkTurquoise</font></td><td><font color="DarkTurquoise">#00CED1</font></td><td bgcolor="DarkTurquoise">rgb(0, 206, 209)</td>    </tr>    <tr>        <td><font color="DarkViolet">DarkViolet</font></td><td><font color="DarkViolet">#9400D3</font></td><td bgcolor="DarkViolet">rgb(148, 0, 211)</td>    </tr>    <tr>        <td><font color="DeepPink">DeepPink</font></td><td><font color="DeepPink">#FF1493</font></td><td bgcolor="DeepPink">rgb(255, 20, 147)</td>    </tr>    <tr>        <td><font color="DeepSkyBlue">DeepSkyBlue</font></td><td><font color="DeepSkyBlue">#00BFFF</font></td><td bgcolor="DeepSkyBlue">rgb(0, 191, 255)</td>    </tr>    <tr>        <td><font color="DimGray">DimGray</font></td><td><font color="DimGray">#696969</font></td><td bgcolor="DimGray">rgb(105, 105, 105)</td>    </tr>    <tr>        <td><font color="DodgerBlue">DodgerBlue</font></td><td><font color="DodgerBlue">#1E90FF</font></td><td bgcolor="DodgerBlue">rgb(30, 144, 255)</td>    </tr>    <tr>        <td><font color="Feldspar">Feldspar</font></td><td><font color="Feldspar">#D19275</font></td><td bgcolor="Feldspar">rgb(209, 146, 117)</td>    </tr>    <tr>        <td><font color="FireBrick">FireBrick</font></td><td><font color="FireBrick">#B22222</font></td><td bgcolor="FireBrick">rgb(178, 34, 34)</td>    </tr>    <tr>        <td><font color="FloralWhite">FloralWhite</font></td><td><font color="FloralWhite">#FFFAF0</font></td><td bgcolor="FloralWhite">rgb(255, 250, 240)</td>    </tr>    <tr>        <td><font color="ForestGreen">ForestGreen</font></td><td><font color="ForestGreen">#228B22</font></td><td bgcolor="ForestGreen">rgb(34, 139, 34)</td>    </tr>    <tr>        <td><font color="Fuchsia">Fuchsia</font></td><td><font color="Fuchsia">#FF00FF</font></td><td bgcolor="Fuchsia">rgb(255, 0, 255)</td>    </tr>    <tr>        <td><font color="Gainsboro">Gainsboro</font></td><td><font color="Gainsboro">#DCDCDC</font></td><td bgcolor="Gainsboro">rgb(220, 220, 220)</td>    </tr>    <tr>        <td><font color="GhostWhite">GhostWhite</font></td><td><font color="GhostWhite">#F8F8FF</font></td><td bgcolor="GhostWhite">rgb(248, 248, 255)</td>    </tr>    <tr>        <td><font color="Gold">Gold</font></td><td><font color="Gold">#FFD700</font></td><td bgcolor="Gold">rgb(255, 215, 0)</td>    </tr>    <tr>        <td><font color="GoldenRod">GoldenRod</font></td><td><font color="GoldenRod">#DAA520</font></td><td bgcolor="GoldenRod">rgb(218, 165, 32)</td>    </tr>    <tr>        <td><font color="Gray">Gray</font></td><td><font color="Gray">#808080</font></td><td bgcolor="Gray">rgb(128, 128, 128)</td>    </tr>    <tr>        <td><font color="Green">Green</font></td><td><font color="Green">#008000</font></td><td bgcolor="Green">rgb(0, 128, 0)</td>    </tr>    <tr>        <td><font color="GreenYellow">GreenYellow</font></td><td><font color="GreenYellow">#ADFF2F</font></td><td bgcolor="GreenYellow">rgb(173, 255, 47)</td>    </tr>    <tr>        <td><font color="HoneyDew">HoneyDew</font></td><td><font color="HoneyDew">#F0FFF0</font></td><td bgcolor="HoneyDew">rgb(240, 255, 240)</td>    </tr>    <tr>        <td><font color="HotPink">HotPink</font></td><td><font color="HotPink">#FF69B4</font></td><td bgcolor="HotPink">rgb(255, 105, 180)</td>    </tr>    <tr>        <td><font color="IndianRed">IndianRed</font></td><td><font color="IndianRed">#CD5C5C</font></td><td bgcolor="IndianRed">rgb(205, 92, 92)</td>    </tr>    <tr>        <td><font color="Indigo">Indigo</font></td><td><font color="Indigo">#4B0082</font></td><td bgcolor="Indigo">rgb(75, 0, 130)</td>    </tr>    <tr>        <td><font color="Ivory">Ivory</font></td><td><font color="Ivory">#FFFFF0</font></td><td bgcolor="Ivory">rgb(255, 255, 240)</td>    </tr>    <tr>        <td><font color="Khaki">Khaki</font></td><td><font color="Khaki">#F0E68C</font></td><td bgcolor="Khaki">rgb(240, 230, 140)</td>    </tr>    <tr>        <td><font color="Lavender">Lavender</font></td><td><font color="Lavender">#E6E6FA</font></td><td bgcolor="Lavender">rgb(230, 230, 250)</td>    </tr>    <tr>        <td><font color="LavenderBlush">LavenderBlush</font></td><td><font color="LavenderBlush">#FFF0F5</font></td><td bgcolor="LavenderBlush">rgb(255, 240, 245)</td>    </tr>    <tr>        <td><font color="LawnGreen">LawnGreen</font></td><td><font color="LawnGreen">#7CFC00</font></td><td bgcolor="LawnGreen">rgb(124, 252, 0)</td>    </tr>    <tr>        <td><font color="LemonChiffon">LemonChiffon</font></td><td><font color="LemonChiffon">#FFFACD</font></td><td bgcolor="LemonChiffon">rgb(255, 250, 205)</td>    </tr>    <tr>        <td><font color="LightBlue">LightBlue</font></td><td><font color="LightBlue">#ADD8E6</font></td><td bgcolor="LightBlue">rgb(173, 216, 230)</td>    </tr>    <tr>        <td><font color="LightCoral">LightCoral</font></td><td><font color="LightCoral">#F08080</font></td><td bgcolor="LightCoral">rgb(240, 128, 128)</td>    </tr>    <tr>        <td><font color="LightCyan">LightCyan</font></td><td><font color="LightCyan">#E0FFFF</font></td><td bgcolor="LightCyan">rgb(224, 255, 255)</td>    </tr>    <tr>        <td><font color="LightGoldenRodYellow">LightGoldenRodYellow</font></td><td><font color="LightGoldenRodYellow">#FAFAD2</font></td><td bgcolor="LightGoldenRodYellow">rgb(250, 250, 210)</td>    </tr>    <tr>        <td><font color="LightGrey">LightGrey</font></td><td><font color="LightGrey">#D3D3D3</font></td><td bgcolor="LightGrey">rgb(211, 211, 211)</td>    </tr>    <tr>        <td><font color="LightGreen">LightGreen</font></td><td><font color="LightGreen">#90EE90</font></td><td bgcolor="LightGreen">rgb(144, 238, 144)</td>    </tr>    <tr>        <td><font color="LightPink">LightPink</font></td><td><font color="LightPink">#FFB6C1</font></td><td bgcolor="LightPink">rgb(255, 182, 193)</td>    </tr>    <tr>        <td><font color="LightSalmon">LightSalmon</font></td><td><font color="LightSalmon">#FFA07A</font></td><td bgcolor="LightSalmon">rgb(255, 160, 122)</td>    </tr>    <tr>        <td><font color="LightSeaGreen">LightSeaGreen</font></td><td><font color="LightSeaGreen">#20B2AA</font></td><td bgcolor="LightSeaGreen">rgb(32, 178, 170)</td>    </tr>    <tr>        <td><font color="LightSkyBlue">LightSkyBlue</font></td><td><font color="LightSkyBlue">#87CEFA</font></td><td bgcolor="LightSkyBlue">rgb(135, 206, 250)</td>    </tr>    <tr>        <td><font color="LightSlateBlue">LightSlateBlue</font></td><td><font color="LightSlateBlue">#8470FF</font></td><td bgcolor="LightSlateBlue">rgb(132, 112, 255)</td>    </tr>    <tr>        <td><font color="LightSlateGray">LightSlateGray</font></td><td><font color="LightSlateGray">#778899</font></td><td bgcolor="LightSlateGray">rgb(119, 136, 153)</td>    </tr>    <tr>        <td><font color="LightSteelBlue">LightSteelBlue</font></td><td><font color="LightSteelBlue">#B0C4DE</font></td><td bgcolor="LightSteelBlue">rgb(176, 196, 222)</td>    </tr>    <tr>        <td><font color="LightYellow">LightYellow</font></td><td><font color="LightYellow">#FFFFE0</font></td><td bgcolor="LightYellow">rgb(255, 255, 224)</td>    </tr>    <tr>        <td><font color="Lime">Lime</font></td><td><font color="Lime">#00FF00</font></td><td bgcolor="Lime">rgb(0, 255, 0)</td>    </tr>    <tr>        <td><font color="LimeGreen">LimeGreen</font></td><td><font color="LimeGreen">#32CD32</font></td><td bgcolor="LimeGreen">rgb(50, 205, 50)</td>    </tr>    <tr>        <td><font color="Linen">Linen</font></td><td><font color="Linen">#FAF0E6</font></td><td bgcolor="Linen">rgb(250, 240, 230)</td>    </tr>    <tr>        <td><font color="Magenta">Magenta</font></td><td><font color="Magenta">#FF00FF</font></td><td bgcolor="Magenta">rgb(255, 0, 255)</td>    </tr>    <tr>        <td><font color="Maroon">Maroon</font></td><td><font color="Maroon">#800000</font></td><td bgcolor="Maroon">rgb(128, 0, 0)</td>    </tr>    <tr>        <td><font color="MediumAquaMarine">MediumAquaMarine</font></td><td><font color="MediumAquaMarine">#66CDAA</font></td><td bgcolor="MediumAquaMarine">rgb(102, 205, 170)</td>    </tr>    <tr>        <td><font color="MediumBlue">MediumBlue</font></td><td><font color="MediumBlue">#0000CD</font></td><td bgcolor="MediumBlue">rgb(0, 0, 205)</td>    </tr>    <tr>        <td><font color="MediumOrchid">MediumOrchid</font></td><td><font color="MediumOrchid">#BA55D3</font></td><td bgcolor="MediumOrchid">rgb(186, 85, 211)</td>    </tr>    <tr>        <td><font color="MediumPurple">MediumPurple</font></td><td><font color="MediumPurple">#9370D8</font></td><td bgcolor="MediumPurple">rgb(147, 112, 216)</td>    </tr>    <tr>        <td><font color="MediumSeaGreen">MediumSeaGreen</font></td><td><font color="MediumSeaGreen">#3CB371</font></td><td bgcolor="MediumSeaGreen">rgb(60, 179, 113)</td>    </tr>    <tr>        <td><font color="MediumSlateBlue">MediumSlateBlue</font></td><td><font color="MediumSlateBlue">#7B68EE</font></td><td bgcolor="MediumSlateBlue">rgb(123, 104, 238)</td>    </tr>    <tr>        <td><font color="MediumSpringGreen">MediumSpringGreen</font></td><td><font color="MediumSpringGreen">#00FA9A</font></td><td bgcolor="MediumSpringGreen">rgb(0, 250, 154)</td>    </tr>    <tr>        <td><font color="MediumTurquoise">MediumTurquoise</font></td><td><font color="MediumTurquoise">#48D1CC</font></td><td bgcolor="MediumTurquoise">rgb(72, 209, 204)</td>    </tr>    <tr>        <td><font color="MediumVioletRed"><mediumvioletred font></mediumvioletred></font></td><td><font color="MediumVioletRed">#C71585</font></td><td bgcolor="MediumVioletRed">rgb(199, 21, 133)</td>    </tr>    <tr>        <td><font color="MidnightBlue">MidnightBlue</font></td><td><font color="MidnightBlue">#191970</font></td><td bgcolor="MidnightBlue">rgb(25, 25, 112)</td>    </tr>    <tr>        <td><font color="MintCream">MintCream</font></td><td><font color="MintCream">#F5FFFA</font></td><td bgcolor="MintCream">rgb(245, 255, 250)</td>    </tr>    <tr>        <td><font color="MistyRose">MistyRose</font></td><td><font color="MistyRose">#FFE4E1</font></td><td bgcolor="MistyRose">rgb(255, 228, 225)</td>    </tr>    <tr>        <td><font color="Moccasin">Moccasin</font></td><td><font color="Moccasin">#FFE4B5</font></td><td bgcolor="Moccasin">rgb(255, 228, 181)</td>    </tr>    <tr>        <td><font color="NavajoWhite">NavajoWhite</font></td><td><font color="NavajoWhite">#FFDEAD</font></td><td bgcolor="NavajoWhite">rgb(255, 222, 173)</td>    </tr>    <tr>        <td><font color="Navy">Navy</font></td><td><font color="Navy">#000080</font></td><td bgcolor="Navy">rgb(0, 0, 128)</td>    </tr>    <tr>        <td><font color="OldLace">OldLace</font></td><td><font color="OldLace">#FDF5E6</font></td><td bgcolor="OldLace">rgb(253, 245, 230)</td>    </tr>    <tr>        <td><font color="Olive"></font></td><td><font color="Olive">#808000</font></td><td bgcolor="Olive">rgb(128, 128, 0)</td>    </tr>    <tr>        <td><font color="OliveDrab">OliveDrab</font></td><td><font color="OliveDrab">#6B8E23</font></td><td bgcolor="OliveDrab">rgb(107, 142, 35)</td>    </tr>    <tr>        <td><font color="Orange">Orange</font></td><td><font color="Orange">#FFA500</font></td><td bgcolor="Orange">rgb(255, 165, 0)</td>    </tr>    <tr>        <td><font color="OrangeRed">OrangeRed</font></td><td><font color="OrangeRed">#FF4500</font></td><td bgcolor="OrangeRed">rgb(255, 69, 0)</td>    </tr>    <tr>        <td><font color="Orchid">Orchid</font></td><td><font color="Orchid">#DA70D6</font></td><td bgcolor="Orchid">rgb(218, 112, 214)</td>    </tr>    <tr>        <td><font color="PaleGoldenRod">PaleGoldenRod</font></td><td><font color="PaleGoldenRod">#EEE8AA</font></td><td bgcolor="PaleGoldenRod">rgb(238, 232, 170)</td>    </tr>    <tr>        <td><font color="PaleGreen">PaleGreen</font></td><td><font color="PaleGreen">#98FB98</font></td><td bgcolor="PaleGreen">rgb(152, 251, 152)</td>    </tr>    <tr>        <td><font color="PaleTurquoise">PaleTurquoise</font></td><td><font color="PaleTurquoise">#AFEEEE</font></td><td bgcolor="PaleTurquoise">rgb(175, 238, 238)</td>    </tr>    <tr>        <td><font color="PaleVioletRed">PaleVioletRed</font></td><td><font color>#D87093</font></td><td bgcolor="PaleVioletRed">rgb(216, 112, 147)</td>    </tr>    <tr>        <td><font color="PapayaWhip">PapayaWhip</font></td><td><font color="PapayaWhip">#FFEFD5</font></td><td bgcolor="PapayaWhip">rgb(255, 239, 213)</td>    </tr>    <tr>        <td><font color="PeachPuff">PeachPuff</font></td><td><font color="PeachPuff">#FFDAB9</font></td><td bgcolor="PeachPuff">rgb(255, 218, 185)</td>    </tr>    <tr>        <td><font color="Peru">Peru</font></td><td><font color="Peru">#CD853F</font></td><td bgcolor="Peru">rgb(205, 133, 63)</td>    </tr>    <tr>        <td><font color="Pink">Pink</font></td><td><font color="Pink">#FFC0CB</font></td><td bgcolor="Pink">rgb(255, 192, 203)</td>    </tr>    <tr>        <td><font color="Plum">Plum</font></td><td><font color="Plum">#DDA0DD</font></td><td bgcolor="Plum">rgb(221, 160, 221)</td>    </tr>    <tr>        <td><font color="PowderBlue">PowderBlue</font></td><td><font color="PowderBlue">#B0E0E6</font></td><td bgcolor="PowderBlue">rgb(176, 224, 230)</td>    </tr>    <tr>        <td><font color="Purple">Purple</font></td><td><font color="Purple">#800080</font></td><td bgcolor="Purple">rgb(128, 0, 128)</td>    </tr>    <tr>        <td><font color="Red">Red</font></td><td><font color="Red">#FF0000</font></td><td bgcolor="Red">rgb(255, 0, 0)</td>    </tr>    <tr>        <td><font color="RosyBrown">RosyBrown</font></td><td><font color="RosyBrown">#BC8F8F</font></td><td bgcolor="RosyBrown">rgb(188, 143, 143)</td>    </tr>    <tr>        <td><font color="RoyalBlue">RoyalBlue</font></td><td><font color="RoyalBlue">#4169E1</font></td><td bgcolor="RoyalBlue">rgb(65, 105, 225)</td>    </tr>    <tr>        <td><font color="SaddleBrown">SaddleBrown</font></td><td><font color="SaddleBrown">#8B4513</font></td><td bgcolor="SaddleBrown">rgb(139, 69, 19)</td>    </tr>    <tr>        <td><font color="Salmon">Salmon</font></td><td><font color="Salmon">#FA8072</font></td><td bgcolor="Salmon">rgb(250, 128, 114)</td>    </tr>    <tr>        <td><font color="SandyBrown">SandyBrown</font></td><td><font color="SandyBrown">#F4A460</font></td><td bgcolor="SandyBrown">rgb(244, 164, 96)</td>    </tr>    <tr>        <td><font color="SeaGreen">SeaGreen</font></td><td><font color="SeaGreen">#2E8B57</font></td><td bgcolor="SeaGreen">rgb(46, 139, 87)</td>    </tr>    <tr>        <td><font color="SeaShell">SeaShell</font></td><td><font color="SeaShell">#FFF5EE</font></td><td bgcolor="SeaShell">rgb(255, 245, 238)</td>    </tr>    <tr>        <td><font color="Sienna">Sienna</font></td><td><font color="Sienna">#A0522D</font></td><td bgcolor="Sienna">rgb(160, 82, 45)</td>    </tr>    <tr>        <td><font color="Silver">Silver</font></td><td><font color="Silver">#C0C0C0</font></td><td bgcolor="Silver">rgb(192, 192, 192)</td>    </tr>    <tr>        <td><font color="SkyBlue">SkyBlue</font></td><td><font color="SkyBlue">#87CEEB</font></td><td bgcolor="SkyBlue">rgb(135, 206, 235)</td>    </tr>    <tr>        <td><font color="SlateBlue">SlateBlue</font></td><td><font color="SlateBlue">#6A5ACD</font></td><td bgcolor="SlateBlue">rgb(106, 90, 205)</td>    </tr>    <tr>        <td><font color="SlateGray">SlateGray</font></td><td><font color="SlateGray">#708090</font></td><td bgcolor="SlateGray">rgb(112, 128, 144)</td>    </tr>    <tr>        <td><font color="Snow">Snow</font></td><td><font color="Snow">#FFFAFA</font></td><td bgcolor="Snow">rgb(255, 250, 250)</td>    </tr>    <tr>        <td><font color="SpringGreen">SpringGreen</font></td><td><font color="SpringGreen">#00FF7F</font></td><td bgcolor="SpringGreen">rgb(0, 255, 127)</td>    </tr>    <tr>        <td><font color="SteelBlue">SteelBlue</font></td><td><font color="SteelBlue">#4682B4</font></td><td bgcolor="SteelBlue">rgb(70, 130, 180)</td>    </tr>    <tr>        <td><font color="Tan">Tan</font></td><td><font color="Tan">#D2B48C</font></td><td bgcolor="Tan">rgb(210, 180, 140)</td>    </tr>    <tr>        <td><font color="Teal">Teal</font></td><td><font color="Teal">#008080</font></td><td bgcolor="Teal">rgb(0, 128, 128)</td>    </tr>    <tr>        <td><font color="Thistle">Thistle</font></td><td><font color="Thistle">#D8BFD8</font></td><td bgcolor="Thistle">rgb(216, 191, 216)</td>    </tr>    <tr>        <td><font color="Tomato">Tomato</font></td><td><font color="Tomato">#FF6347</font></td><td bgcolor="Tomato">rgb(255, 99, 71)</td>    </tr>    <tr>        <td><font color="Turquoise">Turquoise</font></td><td><font color="Turquoise">#40E0D0</font></td><td bgcolor="Turquoise">rgb(64, 224, 208)</td>    </tr>    <tr>        <td><font color="Violet">Violet</font></td><td><font color="Violet">#EE82EE</font></td><td bgcolor="Violet">rgb(238, 130, 238)</td>    </tr>    <tr>        <td><font color="VioletRed"></font></td><td><font color="VioletRed">#D02090</font></td><td bgcolor="VioletRed">rgb(208, 32, 144)</td>    </tr>    <tr>        <td><font color="Wheat">Wheat</font></td><td><font color="Wheat">#F5DEB3</font></td><td bgcolor="Wheat">rgb(245, 222, 179)</td>    </tr>    <tr>        <td><font color="White">White</font></td><td><font color="White">#FFFFFF</font></td><td bgcolor="White">rgb(255, 255, 255)</td>    </tr>    <tr>        <td><font color="WhiteSmoke">WhiteSmoke</font></td><td><font color="WhiteSmoke">#F5F5F5</font></td><td bgcolor="WhiteSmoke">rgb(245, 245, 245)</td>    </tr>    <tr>        <td><font color="Yellow">Yellow</font></td><td><font color="Yellow">#FFFF00</font></td><td bgcolor="Yellow">rgb(255, 255, 0)</td>    </tr>    <tr>        <td><font color="YellowGreen">YellowGreen</font></td><td><font color="YellowGreen">#9ACD32</font></td><td bgcolor="YellowGreen">rgb(154, 205, 50)</td>    </tr></tbody></table>           <h1 id="常用颜色"><a href="#常用颜色" class="headerlink" title="常用颜色"></a><font face="黑体" color="green" size="6">常用颜色</font></h1><p><font color="maroon">color=maroon<br><font color="grey">color=grey<br><font color="silver">color=silver<br><font color="lightgrey">color=lightgrey<br><font color="HotPink">color=HotPink<br><font color="DeepPink">color=DeepPink<br><font color="VioletRed">color=VioletRed<br><font color="Purple">color=Purple<br><font color="navy">color=navy<br><font color="Blue">color=Blue<br><font color="DeepSkyBlue">color=DeepSkyBlue<br><font color="LightSkyBlue">color=LightSkyBlue<br><font color="aqua">color=aqua<br><font color="DarkTurquoise">color=DarkTurquoise（#00CED1）<br><font color="LightSeaGreen">color=LightSeaGreen<br><font color="YellowGreen">color=YellowGreen<br><font color="LawnGreen">color=LawnGreen<br><font color="GreenYellow">color=GreenYellow<br><font color="Yellow">color=Yellow<br><font color="Tomato">color=Tomato<br><font color="red">color=red<br><font color="fuchsia">color=fuchsia<br><font color="MediumOrchid">color=MediumOrchid<br><font color="DarkViolet">color=DarkViolet</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p><h1 id="单元格设置"><a href="#单元格设置" class="headerlink" title="单元格设置"></a>单元格设置</h1><h2 id="单元格和表头"><a href="#单元格和表头" class="headerlink" title="单元格和表头"></a>单元格和表头</h2><p> 使用 | 来分隔不同的单元格，使用 - 来分隔表头和其他行：</p><ul><li>语法</li></ul><pre class="line-numbers language-html"><code class="language-html">表头|表头|表头---|:--:|---:内容|内容|内容内容|内容|内容第二行分割表头和内容。- 有一个就行，为了对齐，多加了几个文字默认居左-两边加：表示文字居中-右边加：表示文字居右注：原生的语法两边都要用 | 包起来。此处省略<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>示例：</li></ul><pre class="line-numbers language-html"><code class="language-html">姓名|技能|排行--|:--:|--:刘备|哭|大哥关羽|打|二哥张飞|骂|三弟<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>效果</li></ul><table><thead><tr><th>姓名</th><th align="center">技能</th><th align="right">排行</th></tr></thead><tbody><tr><td>刘备</td><td align="center">哭</td><td align="right">大哥</td></tr><tr><td>关羽</td><td align="center">打</td><td align="right">二哥</td></tr><tr><td>张飞</td><td align="center">骂</td><td align="right">三弟</td></tr></tbody></table><h2 id="跨行表格"><a href="#跨行表格" class="headerlink" title="跨行表格"></a>跨行表格</h2><ul><li>实现方法<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">rowspan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我占了三行<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>第一列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>第二列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>第三列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第一列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第二列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第三列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第一列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第二列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>第三列<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>实现效果<table><tbody>  <tr>      <th rowspan="3">我占了三行</th>      <th>第一列</th>      <th>第二列</th>      <th>第三列</th>  </tr>  <tr>      <td>第一列</td>      <td>第二列</td>      <td>第三列</td>  </tr>  <tr>      <td>第一列</td>      <td>第二列</td>      <td>第三列</td>  </tr></tbody></table>  </li></ul><h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><h2 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h2><ul><li>语法：<br>无序列表用 - + * 任何一种都可以</li></ul><pre class="line-numbers language-html"><code class="language-html">- 列表内容+ 列表内容* 列表内容注意：- + * 跟内容之间都要有一个空格<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>效果</strong></p><ul><li>列表内容</li></ul><ul><li>列表内容</li></ul><ul><li>列表内容</li></ul><h2 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h2><ul><li>语法：</li><li><ul><li>数字加点</li></ul></li></ul><pre class="line-numbers language-html"><code class="language-html">1. 列表内容2. 列表内容3. 列表内容注意：序号跟内容之间要有空格<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>效果</strong></p><ol><li>列表内容</li><li>列表内容</li><li>列表内容</li></ol><h2 id="列表嵌套"><a href="#列表嵌套" class="headerlink" title="列表嵌套"></a>列表嵌套</h2><p>上一级和下一级之间敲三个空格即可</p><p><strong>效果</strong></p><ul><li>一级无序列表内容</li><li><ul><li>二级无序列表内容</li></ul></li><li><ul><li><ul><li>三级无序列表内容</li></ul></li></ul></li></ul><p>一级有序列表内容</p><ol><li>二级无序列表内容</li><li>二级无序列表内容</li><li>二级无序列表内容</li></ol><p>一级无序列表内容</p><ul><li>二级有序列表内容</li><li>二级有序列表内容</li><li>二级有序列表内容</li></ul><p>一级无序列表内容</p><ul><li><ul><li>二级无序列表内容</li></ul></li><li><ul><li>二级无序列表内容</li></ul></li><li><ul><li>二级无序列表内容</li></ul></li></ul><h1 id="超链接"><a href="#超链接" class="headerlink" title="超链接"></a>超链接</h1><ul><li>语法<pre class="line-numbers language-html"><code class="language-html">[超链接名](超链接地址 "超链接title")title可加可不加<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><p><strong>示例</strong></p><pre class="line-numbers language-html"><code class="language-html">[简书](http://jianshu.com)[百度](http://baidu.com)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>效果</strong></p><p><a href="http://jianshu.com" target="_blank" rel="noopener">简书</a><br><a href="http://baidu.com" target="_blank" rel="noopener">百度</a></p><h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><ul><li>语法</li></ul><pre class="line-numbers language-html"><code class="language-html">![图片alt](图片地址 ''图片title'')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>图片alt就是显示在图片下面的文字，相当于对图片内容的解释。<br>图片title是图片的标题，当鼠标移到图片上时显示的内容。title可加可不加</p><p><strong>示例</strong></p><pre class="line-numbers language-html"><code class="language-html">![南开大学](https://www.nankai.edu.cn/_upload/article/images/3e/ef/e4b9c1aa44a28e5f371ee65451b4/9d9e9b05-2622-40ed-9d9d-f6136b6444cf.jpg "南开")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>效果</strong></p><p><img src="https://www.nankai.edu.cn/_upload/article/images/3e/ef/e4b9c1aa44a28e5f371ee65451b4/9d9e9b05-2622-40ed-9d9d-f6136b6444cf.jpg" alt="南开大学" title="南开"></p><h2 id="设定图片大小"><a href="#设定图片大小" class="headerlink" title="设定图片大小"></a>设定图片大小</h2><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ht.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>251<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>350<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>效果</strong><br><img src="https://www.nankai.edu.cn/_upload/article/images/3e/ef/e4b9c1aa44a28e5f371ee65451b4/9d9e9b05-2622-40ed-9d9d-f6136b6444cf.jpg" width="100" height="100"></p>]]></content>
      
      
      <categories>
          
          <category> Markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shell下获取文件全路径的方法</title>
      <link href="/shell-xia-huo-qu-wen-jian-quan-lu-jing-de-fang-fa/"/>
      <url>/shell-xia-huo-qu-wen-jian-quan-lu-jing-de-fang-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="linux-shell-获取文件夹全文绝对路径"><a href="#linux-shell-获取文件夹全文绝对路径" class="headerlink" title="linux shell 获取文件夹全文绝对路径"></a><font face="黑体" color="blue" size="6">linux shell 获取文件夹全文绝对路径</font></h1><ul><li><p>在ls中列出文件的绝对路径</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">ls</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">"s#^#<span class="token variable"><span class="token variable">`</span><span class="token function">pwd</span><span class="token variable">`</span></span>/#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>就是在每行记录的开头加上当前路径</p></li><li><ul><li><font color="red">实例：</font><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#查看当前目录下的文件全路径，并排除目录的方法</span>ll <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"^d"</span> <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"total"</span><span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$NF</span>}'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">"s#^#<span class="token variable"><span class="token variable">`</span><span class="token function">pwd</span><span class="token variable">`</span></span>/#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul></li></ul><h3 id="ps"><a href="#ps" class="headerlink" title="ps:"></a><font color="red">ps:</font></h3><ul><li><p>在所有行之前/后加入某个字符串</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">sed</span> <span class="token string">'s/^/string/g'</span> <span class="token function">file</span><span class="token comment" spellcheck="true">#</span><span class="token function">sed</span> <span class="token string">'s/$/string/g'</span> <span class="token function">file</span><span class="token comment" spellcheck="true">#</span><span class="token function">find</span>  <span class="token variable">$PWD</span> -maxdepth 1  <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">ls</span> -ld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>列出当前目录下的所有文件（包括隐藏文件）的绝对路径， 对目录不做递归</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">find</span>  <span class="token variable">$PWD</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">ls</span> -ld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>install gitlab runner</title>
      <link href="/install-gitlab-runner/"/>
      <url>/install-gitlab-runner/</url>
      
        <content type="html"><![CDATA[<h1 id="Install-GitLab-Runner"><a href="#Install-GitLab-Runner" class="headerlink" title="Install GitLab Runner"></a><font face="黑体" color="green" size="6">Install GitLab Runner</font></h1><hr><h4 id="1、docker-install"><a href="#1、docker-install" class="headerlink" title="1、docker install"></a>1、docker install</h4><p><a href="https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-convenience-script" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-convenience-script</a></p><h4 id="2、runner-install"><a href="#2、runner-install" class="headerlink" title="2、runner install"></a>2、runner install</h4><p><a href="https://docs.gitlab.com/runner/install/linux-repository.html#installing-the-runner" target="_blank" rel="noopener">https://docs.gitlab.com/runner/install/linux-repository.html#installing-the-runner</a></p><p>gitlab-ce-中文版镜像：</p><blockquote><p>docker pull twang2218/gitlab-ce-zh:latest</p></blockquote><h3 id="gitlab-rb文件配置"><a href="#gitlab-rb文件配置" class="headerlink" title="gitlab.rb文件配置"></a>gitlab.rb文件配置</h3><pre class="line-numbers language-rb"><code class="language-rb">external_url 'http://git.****.com'#配置gitlab访问的URL地址gitlab_pages['inplace_chroot'] = truepages_external_url "http://io.****.com"#配置pages相关信息unicorn['port'] = 8084#默认配置<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="启动docker-容器"><a href="#启动docker-容器" class="headerlink" title="启动docker 容器"></a>启动docker 容器</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#gitlab-ce运行：</span>docker run -dit \  -p 443:443 -p 80:80 -p 22:22 \  --name gitlab \  -v /****/gitlab/config/:/etc/gitlab \  -v /****/gitlab/logs:/var/log/gitlab \  -v /****/gitlab/data:/var/opt/gitlab gitlab/gitlab-ce<span class="token comment" spellcheck="true">#gitlab-ci gitlab-runner01运行</span>docker run -dit \  --name gitlab-runner --restart always \  -v /****/gitlab-runner/config:/etc/gitlab-runner \  -v /var/run/docker.sock:/var/run/docker.sock gitlab/gitlab-runner:latest<span class="token comment" spellcheck="true">#gitlab-runner02 运行</span>docker run -dit \  --name gitlab-runner \  --restart always \  -v /****/gitlab-runner/gitlab-runner02-config:/etc/gitlab-runner \  -v /var/run/docker.sock:/var/run/docker.sock registry.cn-beijing.aliyuncs.com/***/gitlab-runner:v1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="token-查看"><a href="#token-查看" class="headerlink" title="token 查看"></a>token 查看</h3><p><a href="http://git.sys.****.com/admin/runners" target="_blank" rel="noopener">http://git.sys.****.com/admin/runners</a></p><p>vi /etc/gitlab-runner/config.toml</p><blockquote><p>privileged = true</p></blockquote><blockquote><p><a href="https://gitlab.com/" target="_blank" rel="noopener">https://gitlab.com/</a></p></blockquote><blockquote><p>Exf<strong>**</strong></p></blockquote><h3 id="配置runner"><a href="#配置runner" class="headerlink" title="配置runner"></a>配置runner</h3><pre class="line-numbers language-bash"><code class="language-bash">docker <span class="token function">exec</span> -it gitlab-runner gitlab-ci-multi-runner register --locked<span class="token operator">=</span><span class="token string">"false"</span> --run-untagged<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>runner信息输出：</li></ul><pre class="line-numbers language-shell"><code class="language-shell">[root@gitlab-ce-local config]# docker exec -it gitlab-runner gitlab-ci-multi-runner register --locked="false" --run-untagged  Runtime platform                                    arch=amd64 os=linux pid=12 revision=a8a019e0  version=12.3.0  Running in system-mode.  Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/):  http://git.****.com/  Please enter the gitlab-ci token for this runner:  Geoy-M******  Please enter the gitlab-ci description for this runner:  [6990c9803207]:  Please enter the gitlab-ci tags for this runner (comma separated):  node,maven,docker  Registering runner... succeeded                     runner=Geoy-Mk7  Please enter the executor: docker-ssh, ssh, docker+machine, docker-ssh+machine, custom, parallels, shell, virtualbox, kubernetes, docker:  docker  Please enter the default Docker image (e.g. ruby:2.6):  alpine:latest  Runner registered successfully. Feel free to start it, but if it's running already the config should be automatically reloaded!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>runner-配置文件:<br>[root@gitlab-ce-local config]# cat config.toml</li></ul><pre class="line-numbers language-json"><code class="language-json">concurrent = <span class="token number">3</span>check_interval = <span class="token number">0</span><span class="token punctuation">[</span>session_server<span class="token punctuation">]</span>  session_timeout = <span class="token number">1800</span><span class="token punctuation">[</span><span class="token punctuation">[</span>runners<span class="token punctuation">]</span><span class="token punctuation">]</span>  name = <span class="token string">"6990c9803207"</span>  url = <span class="token string">"http://git.*****.com/"</span>  token = <span class="token string">"o******"</span>  executor = <span class="token string">"docker"</span>  <span class="token punctuation">[</span>runners.custom_build_dir<span class="token punctuation">]</span>  <span class="token punctuation">[</span>runners.docker<span class="token punctuation">]</span>    tls_verify = <span class="token boolean">false</span>    image = <span class="token string">"alpine:latest"</span>    privileged = <span class="token boolean">true</span>    disable_entrypoint_overwrite = <span class="token boolean">false</span>    oom_kill_disable = <span class="token boolean">false</span>    disable_cache = <span class="token boolean">false</span>    volumes = <span class="token punctuation">[</span><span class="token string">"/var/run/docker.sock:/var/run/docker.sock"</span><span class="token punctuation">,</span> <span class="token string">"/cache"</span><span class="token punctuation">]</span>    shm_size = <span class="token number">0</span>  <span class="token punctuation">[</span>runners.cache<span class="token punctuation">]</span>    <span class="token punctuation">[</span>runners.cache.s3<span class="token punctuation">]</span>    <span class="token punctuation">[</span>runners.cache.gcs<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置pages"><a href="#配置pages" class="headerlink" title="配置pages"></a>配置pages</h3><p>vim /etc/gitlab/gitlab.rb</p><p>中增加如下信息：</p><pre class="line-numbers language-rb"><code class="language-rb">pages_external_url "http://io.*******.com"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="DNS-解析"><a href="#DNS-解析" class="headerlink" title="DNS 解析"></a>DNS 解析</h2><table><thead><tr><th>主机记录</th><th>记录类型</th><th>解析线路</th><th>记录值</th></tr></thead><tbody><tr><td>*.io</td><td>A</td><td>默认</td><td>10.4.<strong>.</strong></td></tr><tr><td>git.sys</td><td>A</td><td>默认</td><td>10.4.<strong>.</strong></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shell ls 输出显示1列</title>
      <link href="/shell-ls-shu-chu-xian-shi-1-lie/"/>
      <url>/shell-ls-shu-chu-xian-shi-1-lie/</url>
      
        <content type="html"><![CDATA[<h1 id="linux-shell-ls-1-列显示文件"><a href="#linux-shell-ls-1-列显示文件" class="headerlink" title="linux shell ls -1 列显示文件"></a><font face="黑体" color="blue" size="6">linux shell ls -1 列显示文件</font></h1><ul><li>说明：<br>   有时候写shell脚本的时候，经常需要将文件以一列的形式列出来，然后再进行<br>for迭代，之前一般用ls+awk来做，其实ls本身就提供这个功能。</li></ul><ul><li>示例如下：<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@nginx-service001 data<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ls</span>  autosaas  check  logs  nginx  script  software  windows_251  wwwroot  <span class="token punctuation">[</span>root@nginx-service001 data<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ls -1</span>  autosaas  check  logs  nginx  script  software  windows_251  wwwroot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker容器日志清理</title>
      <link href="/docker-rong-qi-ri-zhi-qing-li/"/>
      <url>/docker-rong-qi-ri-zhi-qing-li/</url>
      
        <content type="html"><![CDATA[<ul><li><p><font face="黑体" color="green" size="6">设置一个容器服务的日志大小上限</font></p></li><li><p>在启动容器的时候增加一个参数设置该容器的日志大小，及日志驱动</p><p> –log-driver json-file  #日志驱动<br> –log-opt max-size=[0-9+][k|m|g] #文件的大小<br> –log-opt max-file=[0-9+] #文件数量</p></li><li><p>全局设置<br>编辑文件/etc/docker/daemon.json, 增加以下日志的配置</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"log-driver"</span><span class="token operator">:</span><span class="token string">"json-file"</span><span class="token punctuation">,</span><span class="token property">"log-opts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"max-size"</span><span class="token operator">:</span><span class="token string">"500m"</span><span class="token punctuation">,</span> <span class="token property">"max-file"</span><span class="token operator">:</span><span class="token string">"3"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>  max-size=500m，意味着一个容器日志大小上限是500M，<br>  max-file=3，意味着一个容器有三个日志，分别是id+.json、id+1.json、id+2.json。</p></li><li><p>重启docker守护进程</p><pre class="line-numbers language-shell"><code class="language-shell">systemctl daemon-reloadsystemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><blockquote><table><tr><td bgcolor="yellow"> 注意：设置的日志大小，只对新建的容器有效。</td></tr></table></blockquote>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python install cmdb</title>
      <link href="/python-install-cmdb/"/>
      <url>/python-install-cmdb/</url>
      
        <content type="html"><![CDATA[<p>利用Python 安装部署cmdb</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> os<span class="token keyword">import</span> subprocess<span class="token keyword">import</span> argparse<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">base</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"{} 执行失败"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">install_docker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    base<span class="token punctuation">(</span><span class="token string">"sudo yum install -y yum-utils device-mapper-persistent-data lvm2"</span><span class="token punctuation">)</span>    base<span class="token punctuation">(</span><span class="token string">"sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo"</span><span class="token punctuation">)</span>    base<span class="token punctuation">(</span><span class="token string">"sudo yum makecache fast"</span><span class="token punctuation">)</span>    base<span class="token punctuation">(</span><span class="token string">"sudo yum -y install docker-ce"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"/etc/docker"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        base<span class="token punctuation">(</span><span class="token string">"mkdir -p /etc/docker"</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"/etc/docker/daemon.json"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'{\n    "registry-mirrors": ["https://9f4w4icn.mirror.aliyuncs.com"] \n}'</span><span class="token punctuation">)</span>    base<span class="token punctuation">(</span><span class="token string">"sudo systemctl daemon-reload"</span><span class="token punctuation">)</span>    base<span class="token punctuation">(</span><span class="token string">"sudo systemctl start docker"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"/var/cmdb/db"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        base<span class="token punctuation">(</span><span class="token string">"sudo mkdir -p /var/cmdb/db"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"/var/cmdb/es"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        base<span class="token punctuation">(</span><span class="token string">"sudo mkdir -p /var/cmdb/es"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_db_container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    base<span class="token punctuation">(</span><span class="token string">"sudo docker run --name cmdb-db -d -e MYSQL_ROOT_PASSWORD=cmdbcmdb -v /var/cmdb/db:/var/lib/mysql mysql:5.7.21"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_es_container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    base<span class="token punctuation">(</span><span class="token string">"sudo docker run --name cmdb-es -d -v /var/cmdb/es:/usr/share/elasticsearch/data elasticsearch:5.6.8"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">init_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    base<span class="token punctuation">(</span><span class="token string">"sudo docker run -it --rm --link cmdb-db -e DB_HOST=cmdb-db -e ENV=PRO -e DB_PORT=3306 -e DB_USERNAME=root -e DB_PASSWORD=cmdbcmdb -e DB_NAME=cmdb mingmingtang/cmdb init-db"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_cmdb_container</span><span class="token punctuation">(</span>site_url<span class="token punctuation">,</span> email_host<span class="token punctuation">,</span> email_port<span class="token punctuation">,</span> email_username<span class="token punctuation">,</span> email_password<span class="token punctuation">)</span><span class="token punctuation">:</span>    base<span class="token punctuation">(</span><span class="token string">"sudo docker run -d --name cmdb --link cmdb-db --link cmdb-es -p 80:80 -e ENV=PRO -e SITE_URL={} -e DB_HOST=cmdb-db -e DB_PORT=3306 -e DB_USERNAME=root -e DB_PASSWORD=cmdbcmdb -e DB_NAME=cmdb -e ELASTICSEARCH_HOSTS=cmdb-es -e EMAIL_HOST={} -e EMAIL_PORT={} -e EMAIL_USERNAME={} -e EMAIL_PASSWORD={} mingmingtang/cmdb start"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>site_url<span class="token punctuation">,</span> email_host<span class="token punctuation">,</span> email_port<span class="token punctuation">,</span> email_username<span class="token punctuation">,</span> email_password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">input_para</span><span class="token punctuation">(</span>help<span class="token punctuation">)</span><span class="token punctuation">:</span>    value <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">not</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>        value <span class="token operator">=</span> input<span class="token punctuation">(</span>help<span class="token punctuation">)</span>    <span class="token keyword">return</span> value<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>geteuid<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span><span class="token punctuation">(</span><span class="token string">"请以root权限运行"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># parser = argparse.ArgumentParser()</span>    <span class="token comment" spellcheck="true"># parser.add_argument("--siteurl", type=str, help="E.g: http://cmdb.xxx.com, http://172.17.100.1")</span>    <span class="token comment" spellcheck="true"># parser.add_argument("--emailhost", type=str, help="E.g: http://cmdb.xxx.com, http://172.17.100.1")</span>    <span class="token comment" spellcheck="true"># parser.add_argument("--emailport", type=str, help="E.g: http://cmdb.xxx.com, http://172.17.100.1")</span>    <span class="token comment" spellcheck="true"># parser.add_argument("--emailusername", type=str, help="E.g: http://cmdb.xxx.com, http://172.17.100.1")</span>    <span class="token comment" spellcheck="true"># parser.add_argument("--emailpassword", type=str, help="E.g: http://cmdb.xxx.com, http://172.17.100.1")</span>    <span class="token comment" spellcheck="true"># args = parser.parse_args()</span>    <span class="token comment" spellcheck="true"># SITE_URL = args.SITE_URL</span>    site_url <span class="token operator">=</span> input_para<span class="token punctuation">(</span><span class="token string">"请输入网站域名或IP（http://your domain name）："</span><span class="token punctuation">)</span>    email_host <span class="token operator">=</span> input_para<span class="token punctuation">(</span><span class="token string">"网站邮箱服务器（smtp.domain.com）："</span><span class="token punctuation">)</span>    email_port <span class="token operator">=</span> input_para<span class="token punctuation">(</span><span class="token string">"邮箱服务器端口（25）："</span><span class="token punctuation">)</span>    email_username <span class="token operator">=</span> input_para<span class="token punctuation">(</span><span class="token string">"邮箱用户名（user@domain.com）："</span><span class="token punctuation">)</span>    email_password <span class="token operator">=</span> input_para<span class="token punctuation">(</span><span class="token string">"邮箱密码|独立授权码（password）："</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始安装docker"</span><span class="token punctuation">)</span>    install_docker<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始创建目录"</span><span class="token punctuation">)</span>    create_dir<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始运行mysql容器"</span><span class="token punctuation">)</span>    run_db_container<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始运行elasticsearch容器"</span><span class="token punctuation">)</span>    run_es_container<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"等待数据库启动完成(10s)"</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始初始化数据库"</span><span class="token punctuation">)</span>    init_db<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始运行cmdb"</span><span class="token punctuation">)</span>    run_cmdb_container<span class="token punctuation">(</span>site_url<span class="token punctuation">,</span> email_host<span class="token punctuation">,</span> email_port<span class="token punctuation">,</span> email_username<span class="token punctuation">,</span> email_password<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"完成！"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决docker 容器内访问宿主机“No route to host”的问题</title>
      <link href="/jie-jue-docker-rong-qi-nei-fang-wen-su-zhu-ji-no-route-to-host-de-wen-ti/"/>
      <url>/jie-jue-docker-rong-qi-nei-fang-wen-su-zhu-ji-no-route-to-host-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="解决docker-容器内访问宿主机“No-route-to-host”的问题"><a href="#解决docker-容器内访问宿主机“No-route-to-host”的问题" class="headerlink" title="解决docker 容器内访问宿主机“No route to host”的问题"></a>解决docker 容器内访问宿主机“No route to host”的问题</h1><p>请顺序运行以下命令：</p><pre class="line-numbers language-bash"><code class="language-bash">nmcli connection modify docker0 connection.zone trustedsystemctl stop NetworkManager.servicefirewall-cmd --permanent --zone<span class="token operator">=</span>trusted --change-interface<span class="token operator">=</span>docker0systemctl start NetworkManager.servicenmcli connection modify docker0 connection.zone trustedsystemctl restart docker.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定义js.map文件只允许内网或者指定IP访问</title>
      <link href="/ding-yi-js-map-wen-jian-zhi-yun-xu-nei-wang-huo-zhe-zhi-ding-ip-fang-wen/"/>
      <url>/ding-yi-js-map-wen-jian-zhi-yun-xu-nei-wang-huo-zhe-zhi-ding-ip-fang-wen/</url>
      
        <content type="html"><![CDATA[<h4 id="案例配置："><a href="#案例配置：" class="headerlink" title="案例配置："></a>案例配置：</h4><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span> <span class="token number">443</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token punctuation">;</span>        <span class="token keyword">ssl</span> on<span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate</span>   sslkey<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate_key</span>  sslkey<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token punctuation">.</span>key<span class="token punctuation">;</span>        <span class="token keyword">ssl_session_timeout</span> 5m<span class="token punctuation">;</span>        <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token number">.1</span> TLSv1<span class="token number">.2</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_ciphers</span> AESGCM<span class="token punctuation">:</span>ALL<span class="token punctuation">:</span><span class="token operator">!</span>DH<span class="token punctuation">:</span><span class="token operator">!</span>EXPORT<span class="token punctuation">:</span><span class="token operator">!</span>RC4<span class="token punctuation">:</span><span class="token operator">+</span>HIGH<span class="token punctuation">:</span><span class="token operator">!</span>MEDIUM<span class="token punctuation">:</span><span class="token operator">!</span>LOW<span class="token punctuation">:</span><span class="token operator">!</span>aNULL<span class="token punctuation">:</span><span class="token operator">!</span>eNULL<span class="token punctuation">;</span>        <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>        <span class="token keyword">include</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>        <span class="token keyword">location</span>  <span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span> <span class="token punctuation">{</span>                <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>                <span class="token keyword">alias</span> <span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">;</span>                <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">#判断是否是静态文件，如果是静态文件则不缓存</span>                 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request_filename</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>htm<span class="token operator">|</span>html<span class="token punctuation">)</span>$<span class="token punctuation">)</span>                <span class="token punctuation">{</span>                <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control <span class="token string">"no-cache, no-store"</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">#匹配访问js.map文件的访问权限</span>            <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token punctuation">.</span><span class="token keyword">map</span><span class="token punctuation">)</span><span class="token operator">?</span>$ <span class="token punctuation">{</span>                    <span class="token keyword">set_real_ip_from</span> <span class="token punctuation">{</span>your IP<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#定义可以访问的源IP</span>                    <span class="token keyword">real_ip_header</span>    X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#表示从哪个header属性中获取真实IP</span>                    real_ip_recursive on<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#递归检索真实IP，若从 X-Forwarded-For 中获取，则需递归检索；若像从X-Real-IP中获取，则无需递归。</span>                    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$remote_addr</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#$remote_addr 是客户端真实IP</span>                    <span class="token comment" spellcheck="true">#判断访问源IP如果不是{your IP}则返回403</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$remote_addr</span> <span class="token operator">!=</span> your IP<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">return</span> <span class="token number">403</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token comment" spellcheck="true">#定义proxy1日志输出路径</span>                    <span class="token keyword">access_log</span> <span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>log proxy1<span class="token punctuation">;</span>                    <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>favicon<span class="token punctuation">.</span>ico <span class="token punctuation">{</span>            <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span>       <span class="token punctuation">}</span>        <span class="token keyword">access_log</span>  <span class="token operator">/</span>data<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token punctuation">.</span>log  access<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span>com<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">307</span> <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bat脚本编写</title>
      <link href="/bat-jiao-ben-bian-xie/"/>
      <url>/bat-jiao-ben-bian-xie/</url>
      
        <content type="html"><![CDATA[<h1 id="强制获取管理员运行权限"><a href="#强制获取管理员运行权限" class="headerlink" title="强制获取管理员运行权限"></a>强制获取管理员运行权限</h1><pre><code>%1 mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;cmd.exe&quot;,&quot;/c %~s0 ::&quot;,&quot;&quot;,&quot;runas&quot;,1)(window.close)&amp;&amp;exit</code></pre><h3 id="释放IP及重新获取IP"><a href="#释放IP及重新获取IP" class="headerlink" title="释放IP及重新获取IP"></a>释放IP及重新获取IP</h3><pre class="line-numbers language-bat"><code class="language-bat">@echo off%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exitecho connect release toolsipconfig /releaseecho connection has been releasedecho please waitingecho connect renew toolsipconfig /renewecho connection has been renewpause<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="win7-关闭防火墙"><a href="#win7-关闭防火墙" class="headerlink" title="win7 关闭防火墙"></a>win7 关闭防火墙</h3><pre class="line-numbers language-bat"><code class="language-bat">@echo off(net start|find "Windows Firewall" >nul)&&(net stop MpsSvc>nul&sc config MpsSvc start= disabled>nul)||((sc qc mpssvc|find /i "START_TYPE"|find /i "DISABLED">nul)||sc config MpsSvc start= disabled>nul)echo 完成！&pause>nul<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="win10-关闭防火墙"><a href="#win10-关闭防火墙" class="headerlink" title="win10 关闭防火墙"></a>win10 关闭防火墙</h3><pre class="line-numbers language-bat"><code class="language-bat">@echo off%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exitreg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableAntiSpyware" /d 1 /t REG_DWORDnetsh firewall set opmode mode = disableecho 完成！&pause>nul<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>### </p><pre class="line-numbers language-bat"><code class="language-bat">@echo off%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exitnetsh firewall set opmode mode = enableecho 完成！&pause>nul<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker run -m指定内存大小不生效</title>
      <link href="/docker-run-m-zhi-ding-nei-cun-da-xiao-bu-sheng-xiao/"/>
      <url>/docker-run-m-zhi-ding-nei-cun-da-xiao-bu-sheng-xiao/</url>
      
        <content type="html"><![CDATA[<pre><code>GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet&quot;</code></pre><p>执行docker run的时候，想要指定一下内存大小，用了-m参数，报错如下</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#docker run -id -m 3g -p 7001:7001 197.3.16.51/sysmgr/mywebapptest_app_weblogic:20180820047</span>WARNING: Your kernel does not support swap limit capabilities or the cgroup is not mounted. Memory limited without swap.52380a4896f3f916cd0f95f97e233b30d9406840e10c0c53484b3be9000d0321<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>然后发现虽然我设置堆大小为5G，容器还是创建出来了，3g的限制并没有生效。</p><p>查阅资料发现这个报错是因为宿主机内核的相关功能没有打开。按照下面的设置就行。</p><p>step 1：编辑/etc/default/grub文件<br>将GRUB_CMDLINE_LINUX一行改为</p><pre><code>GRUB_CMDLINE_LINUX=&quot;cgroup_enable=memory swapaccount=1&quot;</code></pre><p>step 2：更新 GRUB，即执行$ </p><pre><code>sudo update-grub</code></pre><p>step 3: 重启系统。</p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用普罗米修斯监控ecs</title>
      <link href="/li-yong-pu-luo-mi-xiu-si-jian-kong-ecs/"/>
      <url>/li-yong-pu-luo-mi-xiu-si-jian-kong-ecs/</url>
      
        <content type="html"><![CDATA[<div align="middle"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29717271&auto=1&height=66"></iframe></div><p>利用脚本部署node_exporter</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment" spellcheck="true">#wget https://github.com/prometheus/node_exporter/releases/download/v0.17.0/node_exporter-0.17.0.linux-amd64.tar.gz</span><span class="token function">rsync</span> -avPLl helen@172.16.6.86:/Users/helen/hoo-pro/hoo-PRO/software/prometheus/node_exporter-0.17.0.linux-amd64.tar.gz ./<span class="token function">tar</span> zxf node_exporter-0.17.0.linux-amd64.tar.gz<span class="token function">mv</span> node_exporter-0.17.0.linux-amd64 /usr/local/node_exporter<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">></span>/usr/lib/systemd/system/node_exporter.service<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>Description<span class="token operator">=</span>https://prometheus.io<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Restart<span class="token operator">=</span>on-failureExecStart<span class="token operator">=</span>/usr/local/node_exporter/node_exporter --collector.systemd --collector.systemd.unit-whitelist<span class="token operator">=</span><span class="token punctuation">(</span>docker<span class="token operator">|</span>kubelet<span class="token operator">|</span>kube-proxy<span class="token operator">|</span>flanneld<span class="token punctuation">)</span>.service<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.targetEOFsystemctl daemon-reloadsystemctl <span class="token function">enable</span> node_exportersystemctl restart node_exporter<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在需要被普罗米修斯监控的ecs上执行此脚本</p><pre><code>bash node_exporter.sh</code></pre><p>然后修改prometheus.yml文件</p><pre class="line-numbers language-yml"><code class="language-yml"># my global configglobal:  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.  # scrape_timeout is set to the global default (10s).# Alertmanager configurationalerting:  alertmanagers:  - static_configs:    - targets:      # - alertmanager:9093# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.rule_files:  # - "first_rules.yml"  # - "second_rules.yml"# A scrape configuration containing exactly one endpoint to scrape:# Here it's Prometheus itself.scrape_configs:  # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.  - job_name: 'prometheus'    # metrics_path defaults to '/metrics'    # scheme defaults to 'http'.    static_configs:    - targets: ['localhost:9090','10.10.249.59:9100','10.10.249.60:9100','192.168.1.35:8080','192.168.1.35:9100','10.10.249.55:9100']    #  labels:    #    instance: k8s-node01<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>修改完成，重启普罗米修斯；</p>]]></content>
      
      
      <categories>
          
          <category> monitor </category>
          
      </categories>
      
      
        <tags>
            
            <tag> monitor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-compose build seafile</title>
      <link href="/docker-compose-build-seafile/"/>
      <url>/docker-compose-build-seafile/</url>
      
        <content type="html"><![CDATA[<div align="middle"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29717271&auto=1&height=66"></iframe></div><p>利用docker-compose部署<br>以下是官方给出的安装方法，详情见<a href="https://docs.seafile.com/published/seafile-manual-cn/extension/fuse.md" target="_blank" rel="noopener">官网</a></p><p>见yml文件</p><pre class="line-numbers language-yml"><code class="language-yml">version: '2.0'services:  db:    image: mariadb:10.1    container_name: seafile-mysql    environment:      - MYSQL_ROOT_PASSWORD=*****      # Requested, set the root's password of MySQL service.      - MYSQL_LOG_CONSOLE=true    volumes:      - /XXXXX/seafile/data/mysql:/var/lib/mysql      # Requested, specifies the path to MySQL data persistent store.    networks:      - seafile-net  memcached:    image: memcached:1.5.6    container_name: seafile-memcached    entrypoint: memcached -m 256    networks:      - seafile-net  seafile:    image: seafileltd/seafile-mc:latest    container_name: seafile    ports:      - "80:80"#      - "443:443"  # If https is enabled, cancel the comment.    volumes:      - /XXXX/seafile/data/seafile-data:/shared      # Requested, specifies the path to Seafile data persistent store.    environment:      - DB_HOST=db      - DB_ROOT_PASSWD=****      # Requested, the value shuold be root's password of MySQL service.#      - TIME_ZONE=Asia/Shanghai# Optional, default is UTC. Should be uncomment and set to your local time zone.      - SEAFILE_ADMIN_EMAIL=huyuhao@xiongmaocar.com      # Specifies Seafile admin user, default is 'me@example.com'.      - SEAFILE_ADMIN_PASSWORD=*****      # Specifies Seafile admin password, default is 'asecret'.      - SEAFILE_SERVER_LETSENCRYPT=false      # Whether use letsencrypt to generate cert.      - SEAFILE_SERVER_HOSTNAME=seafile.xiongmaocar.com      # Specifies your host name.    depends_on:      - db      - memcached    networks:      - seafile-netnetworks:  seafile-net:%<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
